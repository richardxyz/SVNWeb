webpackJsonp([15],{"8tQY":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),o=a.n(n),s=a("exGp"),i=a.n(s),c=a("mvHQ"),r=a.n(c),d=a("Dd8w"),l=a.n(d),u=a("bOdI"),g=a.n(u),p=a("mw3O"),f=a.n(p),m=(a("mtWM"),a("UMo0")),v=(a("9gAg"),a("NYxO")),h=a("Au9i"),_={name:"detail",data:function(){var e;return e={wrapperHeight:0,tac:[],bottomStatus:"",fet:{Page:0,nodata:!1},queryLoading:!1,allLoaded:!1,pages:5,totalnum:"",pagenum:"",imgl:!1,morloading:!1,loadingbox:!1,loading:!1,rg:"加载完毕",olsei:"",show:!0,appId:"",timeStamp:"",Obj:{},nonceStr:"",package:"",signType:"",noMore:!1,paySign:"",mtools:!0},g()(e,"appId",""),g()(e,"timeStamp",""),g()(e,"nonceStr",""),g()(e,"package",""),g()(e,"signType",""),g()(e,"paySign",""),g()(e,"sstarTime",""),g()(e,"snumber",""),g()(e,"smoney",""),g()(e,"scountry",""),g()(e,"scname",""),e},watch:{},methods:l()({loadMore:function(){console.log(1),this.noMore=!1,this.search()},loadTop:function(){var e=this;this.search(1),setTimeout(function(){e.$refs.loadmore.onTopLoaded()},500)}},Object(v.c)(["USEOBJ"]),{format:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,o=t.getDate(),s=t.getHours(),i=t.getMinutes(),c=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(o)+" "+this.add0(s)+":"+this.add0(i)+":"+this.add0(c)},add0:function(e){return e<10?"0"+e:e},details:function(e){var t=this;Object(m.p)({number:e}).then(function(e){200==e.status&&(t.$router.push({path:"/order"}),localStorage.setItem("tabs",r()(e.data.result)),t.USEOBJ(e.data.result)),console.log(e)})},unpaid:function(e){var t=this;return i()(o.a.mark(function a(){var n,s,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(e),t.sstarTime=e.starTime,t.snumber=e.number,t.smoney=e.money,t.scountry=e.country,t.scname=e.cname,n={money:e.money,weiTrade:e.number,openId:e.openid,ip:returnCitySN.cip},a.next=9,Object(m.t)(n);case 9:s=a.sent,i=t,"OK"==s.data.resCode&&(i.appId=s.data.appId,i.timeStamp=s.data.timeStamp,i.nonceStr=s.data.nonceStr,i.package=s.data.package,i.signType=s.data.signType,i.paySign=s.data.paySign,"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",onBridgeReady,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",onBridgeReady),document.attachEvent("onWeixinJSBridgeReady",onBridgeReady)):i.onBridgeReady());case 12:case"end":return a.stop()}},a,t)}))()},onBridgeReady:function(){var e=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign},function(t){"get_brand_wcpay_request:ok"==t.err_msg&&e.$http({method:"post",url:e.oldhttpUrl+"/users/queryByState",data:f.a.stringify({paystatus:t.err_msg,paytime:e.sstarTime,carnumber:e.scountry,jixing:e.scname,number:e.snumber,openId:localStorage.getItem("openid"),money:e.smoney})}).then(function(e){Object(h.MessageBox)({title:"提示",message:"支付成功",closeOnClickModal:!1}).then(function(e){window.location.reload()})})})},delorder:function(e){var t,a=this;console.log(e),h.MessageBox.confirm("",{message:"是否取消订单",confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1}).then((t=i()(o.a.mark(function t(n){var s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("confirm"!=n){t.next=8;break}return console.log(e),s={number:e},console.log(s),t.next=6,Object(m.m)(s);case 6:0==t.sent.data.resCode?(Object(h.MessageBox)("提示","删除订单成功"),window.location.reload()):Object(h.MessageBox)("提示","删除订单失败");case 8:case"end":return t.stop()}},t,a)})),function(e){return t.apply(this,arguments)}))},monelis:function(e){h.MessageBox.confirm("",{message:"是否取消订单",confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1}).then(function(t){if("confirm"==t){var a={number:e};Object(m.f)(a).then(function(e){0==e.data.resCode?(Object(h.MessageBox)("提示","取消成功"),window.location.reload()):Object(h.MessageBox)("提示","取消订单失败")})}})},tack:function(e){console.log(e);var t=this;console.log(window.location.href.split("#")[0]),this.$http.get(t.oldhttpUrl+"/scan/getJSSDKTicket?url="+window.location.href.split("#")[0]).then(function(a){wx.config({debug:!1,appId:a.data.appid,timestamp:a.data.timestamp,nonceStr:a.data.nonceStr,signature:a.data.signature,jsApiList:[a.data.jsApiList]}),wx.ready(function(){wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(a){var n=a.resultStr,o=n.substring(n.indexOf("state=")+6,n.indexOf("#"));h.Indicator.open("Loading...");var s={number:e,deviceId:o};console.log(s),Object(m.A)(s).then(function(e){console.log(e),"0"==e.data.resCode?(h.Indicator.close(),Object(h.MessageBox)({title:"提示",message:"开柜成功，请取出钥匙",closeOnClickModal:!1}).then(function(e){t.$router.push("/home")})):(h.Indicator.close(),Object(h.MessageBox)({title:"提示",message:"开柜失败，请重试",closeOnClickModal:!1}).then(function(e){t.$router.push("/home")}))})}})})})},abc:function(e){console.log(e);var t=this;console.log(window.location.href.split("#")[0]),this.$http.get(t.oldhttpUrl+"/scan/getJSSDKTicket?url="+window.location.href.split("#")[0]).then(function(a){wx.config({debug:!1,appId:a.data.appid,timestamp:a.data.timestamp,nonceStr:a.data.nonceStr,signature:a.data.signature,jsApiList:[a.data.jsApiList]}),wx.ready(function(){wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(a){var n=a.resultStr,o=n.substring(n.indexOf("state=")+6,n.indexOf("#"));alert(o),alert(e),h.Indicator.open("Loading...");var s={number:e,deviceId:o};console.log(s),Object(m.z)(s).then(function(e){console.log(e),"0"==e.data.resCode?(h.Indicator.close(),Object(h.MessageBox)({title:"提示",message:"开柜成功",closeOnClickModal:!1}).then(function(e){t.$router.push("/home")})):(h.Indicator.close(),Object(h.MessageBox)({title:"提示",message:e.data.result,closeOnClickModal:!1}).then(function(e){t.$router.push("/home")}))})}})})})},search:function(){var e=this;if(this.allLoaded)this.loading=!0;else if(!this.queryLoading){this.loading=!this.queryLoading,this.fet.Page++;var t={phone:localStorage.getItem("phone"),Page:this.fet.Page,PageSize:5};console.log(t),Object(m.o)(t).then(function(t){console.log(t),200==t.status&&(console.log(t.data.count),console.log(5*e.fet.Page),t.data.result.length?(e.tac=e.tac.concat(t.data.result),t.data.count<=5*e.fet.Page?e.allLoaded=!0:(e.allLoaded=!1,e.loading=!0),e.loading=e.allLoaded):(e.imgl=!0,e.queryLoading=!0))})}}}),mounted:function(){}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"wrapper",staticClass:"box"},[a("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"lpcile",staticStyle:{"padding-top":"0.2rem",background:"#efefef"},attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"50"}},[e._l(e.tac,function(t){return e.imgl?e._e():a("li",[a("div",{staticClass:"tan"},[a("span",[e._v("订单编号："+e._s(t.number))]),e._v(" "),a("span",[e._v(e._s(t.starTime))])]),e._v(" "),a("p",{staticClass:"rolo"}),e._v(" "),a("div",{staticClass:"tan",on:{click:function(a){e.details(t.number)}}},[a("span",[e._v(e._s(t.cname))]),e._v(" "),a("span",[e._v(e._s(t.country))])]),e._v(" "),a("div",{staticClass:"tan",on:{click:function(a){e.details(t.number)}}},[a("span",[e._v("￥"+e._s(t.money))]),e._v(" "),"1"==t.state?a("span",{class:{actives:"1"==t.state}},[e._v(e._s(e._f("Chose")(t.state)))]):e._e(),e._v(" "),"2"==t.state?a("span",{class:{actives:"2"==t.state}},[e._v(e._s(e._f("Chose")(t.state)))]):e._e(),e._v(" "),"3"==t.state?a("span",{class:{actives:"3"==t.state}},[e._v(e._s(e._f("Chose")(t.state)))]):e._e(),e._v(" "),"4"==t.state?a("span",{class:{actives:"4"==t.state}},[e._v(e._s(e._f("Chose")(t.state)))]):e._e(),e._v(" "),"5"==t.state?a("span",{class:{activesss:"5"==t.state}},[e._v(e._s(e._f("Chose")(t.state)))]):e._e(),e._v(" "),"7"==t.state?a("span",{class:{actives:"7"==t.state}},[e._v(e._s(e._f("Chose")(t.state)))]):e._e()]),e._v(" "),a("p",{staticClass:"rolo"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"tans"},["0"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(255,168,0)"},on:{click:function(a){e.unpaid(t)}}},[e._v("待支付")]):e._e(),e._v(" "),"1"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(255,168,0)"},on:{click:function(a){e.abc(t.number)}}},[e._v("存钥匙")]):e._e(),e._v(" "),"2"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(255,168,0)"},on:{click:function(e){}}},[e._v("待洗车")]):e._e(),e._v(" "),"3"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(255,168,0)"},on:{click:function(e){}}},[e._v("洗车中")]):e._e(),e._v(" "),"4"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(255,168,0)"},on:{click:function(a){e.tack(t.number)}}},[e._v("待取件")]):e._e(),e._v(" "),"5"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(255,168,0)"}},[e._v("已完成")]):e._e(),e._v(" "),"7"==t.state?a("div",{staticStyle:{color:"#fff",background:"rgb(108,108,108)"}},[e._v("订单已取消")]):e._e(),e._v(" "),"1"==t.state||"0"==t.state?a("div",{staticStyle:{color:"rgb(247,92,76)",border:"1px solid rgb(247,92,76)"},on:{click:function(a){e.monelis(t.number)}}},[e._v("取消订单")]):e._e(),e._v(" "),"7"==t.state||"5"==t.state?a("div",{staticStyle:{color:"#fff",background:"red"},on:{click:function(a){e.delorder(t.number)}}},[e._v("删除订单")]):e._e()])])}),e._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:!e.queryLoading,expression:"!queryLoading"}],staticClass:"more_loading",staticStyle:{background:"#e9e9e9"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.allLoaded,expression:"allLoaded"}],staticStyle:{"text-align":"center"}},[e._v("已全部加载")])])],2),e._v(" "),e.imgl?a("div",{staticStyle:{width:"100%","margin-top":"2rem"}},[e._m(0),a("p",{staticStyle:{color:"#787878","text-align":"center",padding:"10px 0"}},[e._v("暂无记录")]),e._v(" "),a("p")]):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticStyle:{width:"2.24rem",height:"1.4rem",margin:"0 auto"}},[t("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:a("x38g"),alt:""}})])}]};var y=a("VU/8")(_,b,!1,function(e){a("beNL"),a("hKK8")},"data-v-3d5b1d92",null);t.default=y.exports},beNL:function(e,t){},hKK8:function(e,t){}});