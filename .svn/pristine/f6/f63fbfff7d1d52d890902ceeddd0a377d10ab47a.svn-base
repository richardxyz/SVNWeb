webpackJsonp([37],{"36k6":function(e,t){},nnjR:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),n=a("exGp"),r=a.n(n),l=a("mw3O"),o=a.n(l),c=a("bH6Z"),d=a("4s4v"),u=a("IYcQ"),p=a("UMo0"),v=(a("NYxO"),a("2UA+"),{components:{SyElTable:c.a,pageSize:u.default},data:function(){return{search:{mac:""},paging:{page:1,pageSize:10,total:0},tableData:[],parkIist:[],equipment:{sid:"",deviceid:"",alias:"",dealer:""},equipmentlist:[],addBox:!1,imgBox:!1,editBox:!1,realBox:!1,universal1:{bind:!1,nobind:!1},arrtable:[],camera:[],bindcamera:[],bindid:"",bindcarid:"",binddeviceid:"",binddeviceid1:"",bindname:"",deviceId:0,rules:d.e}},mounted:function(){this.handleSearchClick()},computed:{},methods:{lck:function(e){console.log(file)},tijiao:function(){var e=this;console.log(this.deviceId);var t="";this.arrtable.forEach(function(e,a){t+=e+","}),t=t.substring(0,t.length-1),console.log(t);var a={file:t,eid:this.deviceId};Object(p.C)(a).then(function(t){0==t.data.resCode?(e.$message({message:"保存成功",type:"success"}),e.imgBox=!1):e.$message({message:"保存失败",type:"success"})})},getwashsiteList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(p._24)(t).then(function(t){if(console.log(t),t.data.result.length>0){for(var a=0;a<t.data.result.length;a++){var s={sid:t.data.result[a].sid,sname:t.data.result[a].sname};e.parkIist.push(s)}console.log(e.parkIist)}else e.parkIist=[]})},handleSearchClick:function(){var e=this,t={};this.search.mac&&(t.mac=this.search.mac),t.page=this.paging.page,t.pageSize=this.paging.pageSize,t.userId=localStorage.getItem("userId"),t.dealer=localStorage.getItem("dealer"),axios({method:"post",url:e.$store.state.magnetism_url+"/geomagnetismEquipment/selectGeomagnetismEquipment",data:o.a.stringify(t)}).then(function(t){console.log(t),t.data.count>0?(e.tableData=t.data.result,e.paging.total=t.data.count):(e.tableData=[],e.paging.total=0)})},handleRemove:function(e,t){console.log(e,t)},clear:function(){this.equipment={sid:"",deviceid:"",alias:""}},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},handleSizeChange:function(e){this.paging.pageSize=e,this.handleSearchClick()},handleCurrentChange:function(e){this.paging.page=e,this.handleSearchClick()},ClickAddEquipment:function(e){var t=this,a=this;this.$refs[e].validate(function(e){e&&(t.equipment.dealer=localStorage.getItem("dealer"),t.equipment.date=t.common.nowDate(),console.log(t.equipment),Object(p.q)(t.equipment).then(function(e){console.log(e),e?(a.addBox=!1,a.$message({message:"添加成功",type:"success"}),a.handleSearchClick()):a.$message({message:"添加失败",type:"warning"})}))})},ClickEditEquipment:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(e){var s={};s.dealer=localStorage.getItem("dealer"),"无"==t.equipment.sid?s.sid=0:s.sid=t.equipment.sid,s.id=t.equipment.id,s.alias=t.equipment.alias,s.deviceid=t.equipment.deviceid,Object(p._6)(s).then(function(e){console.log(e),e?(a.addBox=!1,a.$message({message:"修改成功",type:"success"}),a.handleSearchClick()):a.$message({message:"修改失败",type:"success"})})}})},ClickDeleteequipment:function(e){var t=this,a=this;this.$confirm("确认删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("1"),axios.delete(t.$store.state.wash_test_url+"/parkingCarId/deleteByPrimaryKey?id="+e).then(function(e){console.log(e),0==e.data.resCode?(a.$message({type:"success",message:"删除成功!"}),a.handleSearchClick()):a.$message({type:"error",message:e.data.result})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEditequipment:function(e){this.equipment=e,0==this.equipment.sid&&(this.equipment.sid="无"),this.editBox=!0,this.addBox=!0,this.bindcarid=e.deviceid,this.getbindinfoList()},bind:function(e){this.universal1.bind=!0,this.bindid=e.id,this.bindcarid=e.deviceid,this.getwashinfoList()},nobind:function(e){this.universal1.nobind=!0,this.bindid=e.id,this.bindcarid=e.deviceid,this.getbindinfoList()},barrierclick:function(){if(""==this.binddeviceid)that.$message.error("带*的数据不能为空哦！");else{for(var e=0;e<this.camera.length;e++)this.binddeviceid==this.camera[e].deviceId&&(this.bindname=this.camera[e].alias);var t={carid:this.binddeviceid,deviceid:this.bindcarid,name:this.bindname},a=this;axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/selectByinsertSelective",data:o.a.stringify(t)}).then(function(e){console.log(e),0==e.data.resCode?(a.$message({message:"绑定成功",type:"success"}),a.universal1.bind=!1,a.handleSearchClick()):a.$message({message:e.data.result,type:"error"})})}},nobindclick:function(){var e={deviceid:this.bindcarid,carid:this.binddeviceid1},t=this;axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/delectByinsertSelective",data:o.a.stringify(e)}).then(function(e){console.log(e),0==e.data.resCode?(t.$message({message:"解绑成功",type:"success"}),t.universal1.nobind=!1,t.handleSearchClick()):t.$message({message:e.data.result,type:"error"})})},getwashinfoList:function(){var e={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")},t=this;axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/selectByBrakeWashCar",data:o.a.stringify(e)}).then(function(e){console.log(e),0==e.data.resCode?t.camera=e.data.result:t.camera=[]})},getbindinfoList:function(){var e={deviceid:this.bindcarid},t=this;t.bindcamera=[],axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/selectByParkingCarEquipment",data:o.a.stringify(e)}).then(function(e){console.log(e),0==e.data.resCode?(t.bindcamera=e.data.result,t.binddeviceid1=t.bindcamera[0].carid,console.log(t.bindcamera)):(t.$message({message:e.data.result,type:"error"}),t.bindcamera=[],t.binddeviceid1="")})},hangd:function(e,t){1==t.length&&this.$message({type:"error",message:"最多添加一个apk文件"})},hangds:function(e,t){5==t.length&&this.$message({type:"error",message:"最多上传5张图片"})},requasts:function(e){var t=this;return r()(i.a.mark(function a(){var s,n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(s=new FormData).append("file",e.file),n={headers:{"Content-Type":"multipart/form-data"}},t.next=5,Object(p.r)(s,n);case 5:0==(r=t.sent).data.resCode&&console.log(r);case 7:case"end":return t.stop()}},a,t)}))()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},requast:function(e){var t=this;return r()(i.a.mark(function a(){var s,n,r;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(s=new FormData).append("file",e.file),n={headers:{"Content-Type":"multipart/form-data"}},a.next=5,Object(p._36)(s,n);case 5:0==(r=a.sent).data.resCode&&(console.log(r),console.log(r.data.imageUrl),t.$message.success("上传图片成功"),t.arrtable.push(r.data.imageUrl));case 7:case"end":return a.stop()}},a,t)}))()},handleset:function(e){this.deviceId=e,this.imgBox=!0},handleRealTime:function(e){this.deviceId=e,this.getRealBox({id:e})&&(console.log(this.$store.state,this.cellList),this.realBox=!0)}}}),g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"equipmentList"}},[a("div",{staticClass:"header"},[a("div",{staticClass:"headerTitle"},[a("router-link",{staticClass:"router-link-active",attrs:{to:"/pageHome/magnetismList",tag:"span"}},[e._v("地磁管理")]),e._v(" "),a("router-link",{attrs:{to:"/pageHome/magnetismRecord",tag:"span"}},[e._v("设备记录")])],1)]),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("MAC地址：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.mac,callback:function(t){e.$set(e.search,"mac",t)},expression:"search.mac"}})],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.handleSearchClick}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"MAC地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.mac))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.mac))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"地磁安装的泊位编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.berthcode))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.berthcode))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"地磁信号(dBm)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.rsrp))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.rsrp))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"电池电压(mV)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.voltage))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.voltage))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"地磁状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[0==t.row.status?a("el-tag",{attrs:{color:"#5daf34"}},[e._v("空闲")]):e._e(),e._v(" "),1==t.row.status?a("el-tag",{attrs:{color:"#c9521e"}},[e._v("占用")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"上报时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(e._f("validate")(t.row.uploadtime)))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(e._f("validate")(t.row.uploadtime)))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"消息类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.datatype?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v("业务数据")]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v("业务数据")])])]):e._e(),e._v(" "),2==t.row.datatype?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v("心跳信息")]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v("心跳信息")])])]):e._e()]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.editBox?"查看修改洗车机":"添加洗车机",visible:e.addBox},on:{"update:visible":function(t){e.addBox=t}}},[a("el-form",{ref:"equipment",attrs:{inline:!0,model:e.equipment,rules:e.rules}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备序号",prop:"deviceid"}},[a("el-input",{attrs:{disabled:e.editBox},model:{value:e.equipment.deviceid,callback:function(t){e.$set(e.equipment,"deviceid",t)},expression:"equipment.deviceid"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备名称",prop:"alias"}},[a("el-input",{model:{value:e.equipment.alias,callback:function(t){e.$set(e.equipment,"alias",t)},expression:"equipment.alias"}})],1)],1)],1),e._v(" "),e.editBox?a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"摄像头名称",prop:"alias"}},[a("el-select",{attrs:{placeholder:"请选择摄像头",disabled:"true"},model:{value:e.binddeviceid1,callback:function(t){e.binddeviceid1=t},expression:"binddeviceid1"}},e._l(e.bindcamera,function(e){return a("el-option",{key:e.carid,attrs:{label:e.name,value:e.carid}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}})],1):e._e(),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.addBox=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:function(t){e.editBox?e.ClickEditEquipment("equipment"):e.ClickAddEquipment("equipment")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"绑定摄像头",visible:e.universal1.bind},on:{"update:visible":function(t){e.$set(e.universal1,"bind",t)}}},[a("div",{staticClass:"totalcard"},[a("div",{staticClass:"leftcard"},[a("span",{staticClass:"spanClass"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("摄像头名称：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择摄像头",clearable:""},model:{value:e.binddeviceid,callback:function(t){e.binddeviceid=t},expression:"binddeviceid"}},e._l(e.camera,function(e){return a("el-option",{key:e.deviceId,attrs:{label:e.alias,value:e.deviceId}})}))],1),e._v(" "),a("span",{staticClass:"spanClass"},[e._v("备注：")]),e._v(" "),a("div",{staticClass:"little"},[e._v(e._s(this.$store.state.size))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal1.bind=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.barrierclick}},[e._v("确定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"解绑摄像头",visible:e.universal1.nobind},on:{"update:visible":function(t){e.$set(e.universal1,"nobind",t)}}},[a("div",{staticClass:"totalcard"},[a("div",{staticClass:"leftcard"},[a("span",{staticClass:"spanClass"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("摄像头名称：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择摄像头"},model:{value:e.binddeviceid1,callback:function(t){e.binddeviceid1=t},expression:"binddeviceid1"}},e._l(e.bindcamera,function(e){return a("el-option",{key:e.carid,attrs:{label:e.name,value:e.carid}})}))],1),e._v(" "),a("span",{staticClass:"spanClass"},[e._v("备注：")]),e._v(" "),a("div",{staticClass:"little"},[e._v(e._s(this.$store.state.size))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal1.nobind=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.nobindclick}},[e._v("解绑")])],1)]),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,15,20],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[]};var m=a("VU/8")(v,g,!1,function(e){a("36k6")},"data-v-81e0b198",null);t.default=m.exports}});