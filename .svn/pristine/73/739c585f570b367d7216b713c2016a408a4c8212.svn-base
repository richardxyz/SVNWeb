webpackJsonp([96],{Fc1c:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),r=a.n(i),l=a("Dd8w"),n=a.n(l),o=a("mw3O"),s=a.n(o),c=a("NYxO"),g=a("UMo0"),p=(a("4s4v"),{data:function(){return{addParkingLot:!1,showDialog:!1,parkIist:[],tableData:[],vehicleCategoryList:[],vehicleTypeList:[],search:{ruleName:"",parkingId:""},paging:{page:1,pageSize:10,total:0},parkinglot:{parkingId:"",parkingName:"",ruleName:"",vehicleNameId:"",carCategoryId:"",parkingFeeDescription:"",price:"",offline:0,priceunit:"小时",freeTime:"",highPrice:"",highTime:"",timeOut:"",chargingType:"24小时",region:"",dealer:localStorage.getItem("dealer")},rules:{ruleName:[{required:!0,message:"不能为空",trigger:"blur"}],parkingId:[{required:!0,message:"不能为空",trigger:"blur"}],vehicleNameId:[{required:!0,message:"不能为空",trigger:"blur"}],carCategoryId:[{required:!0,message:"不能为空",trigger:"blur"}],price:[{required:!0,message:"不能为空",trigger:"blur"}],region:[{required:!0,message:"不能为空",trigger:"blur"}],offline:[{required:!0,message:"不能为空",trigger:"blur"}],priceunit:[{required:!0,message:"不能为空",trigger:"blur"}],chargingType:[{required:!0,message:"不能为空",trigger:"blur"}]}}},mounted:function(){this.getParkingLotListApiList()},computed:n()({},Object(c.c)({parkingLotInfo:"getParkingLotInfo",parkingLotDevList:"getParkingLotDevList"}),Object(c.e)(["totals"])),methods:n()({},Object(c.b)(["initParkingDevList","toDeleteParkdev","toAddDevList","toEditDevList"]),{getParkingLotListApiList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(g._13)(t).then(function(t){console.log(t),e.parkIist=t.data.result,e.search.parkingId=t.data.result[0].id,e.handleSearchClick()})},repla:function(e){return this.parkingLotInfo.forEach(function(t,a){t.id==e&&(e=t.parking_name)}),e},chooseVehicleCategory:function(e){return this.vehicleCategoryList.forEach(function(t,a){t.id==e&&(e=t.name)}),e},chooseVehicleType:function(e){return this.vehicleTypeList.forEach(function(t,a){t.id==e&&(e=t.vehicleName)}),e},clear:function(){this.parkinglot={parkingId:"",parkingName:"",ruleName:"",vehicleNameId:"",carCategoryId:"",parkingFeeDescription:"",price:"",offline:0,priceunit:"小时",freeTime:"",highPrice:"",highTime:"",timeOut:"",chargingType:"24小时",region:"",dealer:localStorage.getItem("dealer")},this.parkinglot.parkingId=this.search.parkingId},handleSearchClick:function(){var e=this,t={pageSize:this.paging.pageSize,page:this.paging.page,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer"),parkingId:this.search.parkingId};this.search.ruleName&&(t.ruleName=this.search.ruleName),this.search.parkingId&&(t.parkingId=this.search.parkingId),axios({method:"post",url:e.$store.state.parking_url+"/parkingLotChargeRule/selectByParkingLotChargeRule",data:s.a.stringify(t)}).then(function(t){console.log(t),0==t.data.code?(e.tableData=t.data.result,e.paging.total=t.data.count):(e.tableData=[],e.paging.total=0)}),this.getVehicleType(),this.getVehicleCategory()},handleCurrentChange:function(e){console.log(e),this.paging.page=e,this.handleSearchClick()},handleSizeChange:function(e){this.paging.pageSize=e,this.handleSearchClick()},ClickAddParkinglot:function(e){var t=this,a=this;a.parkinglot.parkingName=a.repla(a.parkinglot.parkingId),a.parkinglot.price=Number(a.parkinglot.price).toFixed(2),a.parkinglot.highPrice=Number(a.parkinglot.highPrice).toFixed(2),a.parkinglot.dealer=localStorage.getItem("dealer"),console.log(a.parkinglot),this.$refs[e].validate(function(e){e&&axios({method:"post",url:a.$store.state.parking_url+"/parkingLotChargeRule/insertByParkingLotChargeRule",data:s.a.stringify(a.parkinglot)}).then(function(e){console.log(e),0==e.data.code?(t.showDialog=!1,t.$message({message:"添加成功",type:"success"}),t.handleSearchClick()):(t.showDialog=!1,t.$message({message:"添加失败",type:"error"}),t.handleSearchClick())})})},ClickEditParkinglot:function(e){var t=this,a=this;delete this.parkinglot.data,this.$refs[e].validate(function(e){e&&(console.log(t.parkinglot),axios({method:"post",url:a.$store.state.parking_url+"/parkingLotChargeRule/updateByParkingLotChargeRule",data:s.a.stringify(t.parkinglot)}).then(function(e){console.log(e),0==e.data.code?(t.showDialog=!1,t.$message({message:"修改成功",type:"success"}),t.handleSearchClick()):(t.showDialog=!1,t.$message({message:e.data.result,type:"error"}),t.handleSearchClick())}))})},ClickDeleteParkinglot:function(e){var t=this,a=this;this.$confirm("确认删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){axios({method:"post",url:a.$store.state.parking_url+"/parkingLotChargeRule/deleteByPrimaryKey",data:s.a.stringify({id:e})}).then(function(e){console.log(e),0==e.data.code?(t.$message({type:"success",message:"删除成功"}),a.handleSearchClick()):(t.$message({type:"error",message:"删除失败"}),a.handleSearchClick())})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEditParkinglot:function(e){console.log(e),r()(this.parkinglot,e),this.showDialog=!0,this.addParkingLot=!1},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},getVehicleType:function(){var e=this,t={pageSize:this.paging.pageSize,page:this.paging.page,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer"),parkingId:this.search.parkingId};axios({method:"post",url:e.$store.state.parking_url+"/parkingLotVehicle/selectParkingLotVehicle",data:s.a.stringify(t)}).then(function(t){console.log(t),0==t.data.code?e.vehicleTypeList=t.data.result:e.vehicleTypeList=[]})},getVehicleCategory:function(){var e=this,t={pageSize:this.paging.pageSize,page:this.paging.page,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer"),parkingId:this.search.parkingId};axios({method:"post",url:e.$store.state.parking_url+"/parkingVehicleCategory/selectParkingVehicleCategory",data:s.a.stringify(t)}).then(function(t){console.log(t),0==t.data.code?e.vehicleCategoryList=t.data.result:e.vehicleCategoryList=[]})}})}),u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"cheweisuo"}},[e._m(0),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("停车场名称：")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){e.handleSearchClick()}},model:{value:e.search.parkingId,callback:function(t){e.$set(e.search,"parkingId",t)},expression:"search.parkingId"}},e._l(e.parkIist,function(e){return a("el-option",{key:e.id,attrs:{label:e.parking_name,value:e.id}})})),e._v(" "),a("span",[e._v("规则名称：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.ruleName,callback:function(t){e.$set(e.search,"ruleName",t)},expression:"search.ruleName"}})],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){e.addParkingLot=!0,e.showDialog=!0,e.clear()}}},[e._v("添加")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.handleSearchClick}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{label:"规则名称",prop:"ruleName"}}),e._v(" "),a("el-table-column",{attrs:{label:"计费方式",prop:"chargingType"}}),e._v(" "),a("el-table-column",{attrs:{label:"停车场名称",prop:"parkingName"}}),e._v(" "),a("el-table-column",{attrs:{label:"车类"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.chooseVehicleCategory(t.row.carCategoryId)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"规则描述",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v("收费限额:"+e._s(t.row.highPrice)+"元")]),e._v(" "),a("p",[e._v("计费设置:按"+e._s(t.row.priceunit)+"计费")]),e._v(" "),a("p",[e._v("免费时长:"+e._s(t.row.freeTime)+"分钟")]),e._v(" "),a("p",[e._v("停车时间:"+e._s(t.row.freeTime)+"分钟内，收费0.00元，之后每"+e._s("小时"==t.row.priceunit?"60":"30")+"分钟收费"+e._s(t.row.price)+"元")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("i",{staticClass:"icon-change el-icon-edit",on:{click:function(a){e.handleEditParkinglot(t.row)}}})]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(a){e.ClickDeleteParkinglot(t.row.id)}}})])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.addParkingLot?"新增收费规则":"修改收费规则",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[a("el-form",{ref:"parkinglot",attrs:{inline:!0,model:e.parkinglot,rules:e.rules}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"规则名称:",prop:"ruleName"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.parkinglot.ruleName,callback:function(t){e.$set(e.parkinglot,"ruleName",t)},expression:"parkinglot.ruleName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"停车场名称:",prop:"parkingId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",disabled:"true"},model:{value:e.parkinglot.parkingId,callback:function(t){e.$set(e.parkinglot,"parkingId",t)},expression:"parkinglot.parkingId"}},[a("el-option",{attrs:{label:"未选择"}}),e._v(" "),e._l(e.parkIist,function(e){return a("el-option",{key:e.id,attrs:{label:e.parking_name,value:e.id}})})],2)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"计费方式:",prop:"chargingType"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.parkinglot.chargingType,callback:function(t){e.$set(e.parkinglot,"chargingType",t)},expression:"parkinglot.chargingType"}},e._l([{type:1,label:"24小时"},{type:2,label:"12小时"},{type:3,label:"白天/夜间"},{type:4,label:"自然天"}],function(e){return a("el-option",{key:e.type,attrs:{label:e.label,value:e.label}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车类:",prop:"carCategoryId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.parkinglot.carCategoryId,callback:function(t){e.$set(e.parkinglot,"carCategoryId",t)},expression:"parkinglot.carCategoryId"}},e._l(e.vehicleCategoryList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"计费设置:",prop:"priceunit"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.parkinglot.priceunit,callback:function(t){e.$set(e.parkinglot,"priceunit",t)},expression:"parkinglot.priceunit"}},e._l([{type:0,label:"小时"},{type:1,label:"半小时"}],function(e){return a("el-option",{key:e.type,attrs:{label:e.label,value:e.label}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"单价:",prop:"price"}},[a("el-input",{model:{value:e.parkinglot.price,callback:function(t){e.$set(e.parkinglot,"price",t)},expression:"parkinglot.price"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"收费限额:",prop:"highPrice"}},[a("el-input",{model:{value:e.parkinglot.highPrice,callback:function(t){e.$set(e.parkinglot,"highPrice",t)},expression:"parkinglot.highPrice"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"免费时长:",prop:"freeTime"}},[a("el-input",{model:{value:e.parkinglot.freeTime,callback:function(t){e.$set(e.parkinglot,"freeTime",t)},expression:"parkinglot.freeTime"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"最高时长:",prop:"highTime"}},[a("el-input",{model:{value:e.parkinglot.highTime,callback:function(t){e.$set(e.parkinglot,"highTime",t)},expression:"parkinglot.highTime"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"超时时长:",prop:"timeOut"}},[a("el-input",{model:{value:e.parkinglot.timeOut,callback:function(t){e.$set(e.parkinglot,"timeOut",t)},expression:"parkinglot.timeOut"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"收费说明:",prop:"parkingFeeDescription"}},[a("el-input",{model:{value:e.parkinglot.parkingFeeDescription,callback:function(t){e.$set(e.parkinglot,"parkingFeeDescription",t)},expression:"parkinglot.parkingFeeDescription"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}})],1),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:function(t){e.addParkingLot?e.ClickAddParkinglot("parkinglot"):e.ClickEditParkinglot("parkinglot")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[1,2,3,10,11,12],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"headerTitle"},[t("span",[this._v("收费规则")])])])}]};var d=a("VU/8")(p,u,!1,function(e){a("Ww1a")},"data-v-047727b6",null);t.default=d.exports},Ww1a:function(e,t){}});