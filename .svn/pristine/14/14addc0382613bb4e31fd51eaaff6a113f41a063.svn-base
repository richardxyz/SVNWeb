webpackJsonp([82],{"1ldR":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),s=a.n(i),n=a("exGp"),l=a.n(n),r=a("mw3O"),o=a.n(r),c=a("bH6Z"),d=a("4s4v"),u=a("IYcQ"),p=a("UMo0"),f=(a("NYxO"),a("2UA+"),{components:{SyElTable:c.a,pageSize:u.default},data:function(){return{search:{deviceid:""},paging:{page:1,pageSize:10,total:0},tableData:[],parkIist:[],equipment:{sid:"",deviceid:"",alias:"",dealer:""},equipmentlist:[],addBox:!1,imgBox:!1,editBox:!1,realBox:!1,universal1:{bind:!1,nobind:!1},arrtable:[],camera:[],bindcamera:[],bindid:"",bindcarid:"",binddeviceid:"",binddeviceid1:"",bindname:"",deviceId:0,rules:d.e}},mounted:function(){this.getwashsiteList(),this.handleSearchClick()},computed:{},methods:{lck:function(e){console.log(file)},tijiao:function(){var e=this;console.log(this.deviceId);var t="";this.arrtable.forEach(function(e,a){t+=e+","}),t=t.substring(0,t.length-1),console.log(t);var a={file:t,eid:this.deviceId};Object(p.C)(a).then(function(t){0==t.data.resCode?(e.$message({message:"保存成功",type:"success"}),e.imgBox=!1):e.$message({message:"保存失败",type:"success"})})},getwashsiteList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(p._24)(t).then(function(t){if(console.log(t),t.data.result.length>0){for(var a=0;a<t.data.result.length;a++){var i={sid:t.data.result[a].sid,sname:t.data.result[a].sname};e.parkIist.push(i)}console.log(e.parkIist)}else e.parkIist=[]})},handleSearchClick:function(){var e=this,t={};this.search.deviceid&&(t.deviceid=this.search.deviceid),t.page=this.paging.page,t.pageSize=this.paging.pageSize,t.userId=localStorage.getItem("userId"),t.dealer=localStorage.getItem("dealer"),Object(p._30)(t).then(function(t){var a;(console.log(t.data),0==t.data.resCode)?function(){e.paging.total=t.data.count;var i=[],s=function(){var s={id:t.data.result[a].id,deviceid:t.data.result[a].deviceid};e.equipmentlist.push(s);var n={alias:t.data.result[a].alias,date:t.data.result[a].date,dealer:t.data.result[a].dealer,deviceid:t.data.result[a].deviceid,id:t.data.result[a].id,number:t.data.result[a].number,run:t.data.result[a].run,sid:t.data.result[a].sid,succ:t.data.result[a].succ,bindcar:[]};axios({method:"post",url:e.$store.state.wash_test_url+"/parkingCarId/selectByParkingCarEquipment",data:o.a.stringify({deviceid:n.deviceid})}).then(function(e){console.log(e),0==e.data.resCode?e.data.result.length>0?n.bindcar=e.data.result:n.bindcar=0:(n.bindcarid=0,n.bindcarname=0),i.push(n)})};for(a=0;a<t.data.count;a++)s();e.tableData=i}():(e.tableData=[],e.paging.total=0);console.log(e.tableData)})},handleRemove:function(e,t){console.log(e,t)},clear:function(){this.equipment={sid:"",deviceid:"",alias:""}},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},handleSizeChange:function(e){this.paging.pageSize=e,this.handleSearchClick()},handleCurrentChange:function(e){this.paging.page=e,this.handleSearchClick()},ClickAddEquipment:function(e){var t=this,a=this;this.$refs[e].validate(function(e){e&&(t.equipment.dealer=localStorage.getItem("dealer"),t.equipment.date=t.common.nowDate(),console.log(t.equipment),Object(p.q)(t.equipment).then(function(e){console.log(e),e?(a.addBox=!1,a.$message({message:"添加成功",type:"success"}),a.handleSearchClick()):a.$message({message:"添加失败",type:"warning"})}))})},ClickEditEquipment:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(e){var i={};i.dealer=localStorage.getItem("dealer"),"无"==t.equipment.sid?i.sid=0:i.sid=t.equipment.sid,i.id=t.equipment.id,i.alias=t.equipment.alias,i.deviceid=t.equipment.deviceid,Object(p._6)(i).then(function(e){console.log(e),e?(a.addBox=!1,a.$message({message:"修改成功",type:"success"}),a.handleSearchClick()):a.$message({message:"修改失败",type:"success"})})}})},ClickDeleteequipment:function(e){var t=this,a=this;this.$confirm("确认删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("1"),axios.delete(t.$store.state.wash_test_url+"/parkingCarId/deleteByPrimaryKey?id="+e).then(function(e){console.log(e),0==e.data.resCode?(a.$message({type:"success",message:"删除成功!"}),a.handleSearchClick()):a.$message({type:"error",message:e.data.result})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEditequipment:function(e){this.equipment=e,0==this.equipment.sid&&(this.equipment.sid="无"),this.editBox=!0,this.addBox=!0,this.bindcarid=e.deviceid,this.getbindinfoList()},bind:function(e){this.universal1.bind=!0,this.bindid=e.id,this.bindcarid=e.deviceid,this.getwashinfoList()},nobind:function(e){this.universal1.nobind=!0,this.bindid=e.id,this.bindcarid=e.deviceid,this.getbindinfoList()},barrierclick:function(e){for(var t=0;t<this.camera.length;t++)e==this.camera[t].deviceId&&(this.bindname=this.camera[t].alias);var a={carid:e,deviceid:this.bindcarid,name:this.bindname},i=this;axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/selectByinsertSelective",data:o.a.stringify(a)}).then(function(e){console.log(e),0==e.data.resCode?(i.$message({message:"绑定成功",type:"success"}),i.universal1.bind=!1,i.handleSearchClick()):i.$message({message:e.data.result,type:"error"})})},nobindclick:function(e){var t={deviceid:this.bindcarid,carid:e},a=this;axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/delectByinsertSelective",data:o.a.stringify(t)}).then(function(e){console.log(e),0==e.data.resCode?(a.$message({message:"解绑成功",type:"success"}),a.universal1.nobind=!1,a.handleSearchClick()):a.$message({message:e.data.result,type:"error"})})},getwashinfoList:function(){var e={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")},t=this;axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/selectByBrakeWashCar",data:o.a.stringify(e)}).then(function(e){console.log(e),0==e.data.resCode?t.camera=e.data.result:t.camera=[]})},getbindinfoList:function(){var e={deviceid:this.bindcarid},t=this;t.bindcamera=[],axios({method:"post",url:this.$store.state.wash_test_url+"/parkingCarId/selectByParkingCarEquipment",data:o.a.stringify(e)}).then(function(e){console.log(e),0==e.data.resCode?(t.bindcamera=e.data.result,t.binddeviceid1=t.bindcamera[0].carid,console.log(t.bindcamera)):(t.$message({message:e.data.result,type:"error"}),t.bindcamera=[],t.binddeviceid1="")})},hangd:function(e,t){1==t.length&&this.$message({type:"error",message:"最多添加一个apk文件"})},hangds:function(e,t){5==t.length&&this.$message({type:"error",message:"最多上传5张图片"})},requasts:function(e){var t=this;return l()(s.a.mark(function a(){var i,n,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new FormData).append("file",e.file),n={headers:{"Content-Type":"multipart/form-data"}},t.next=5,Object(p.r)(i,n);case 5:0==(l=t.sent).data.resCode&&console.log(l);case 7:case"end":return t.stop()}},a,t)}))()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},requast:function(e){var t=this;return l()(s.a.mark(function a(){var i,n,l;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(i=new FormData).append("file",e.file),n={headers:{"Content-Type":"multipart/form-data"}},a.next=5,Object(p._36)(i,n);case 5:0==(l=a.sent).data.resCode&&(console.log(l),console.log(l.data.imageUrl),t.$message.success("上传图片成功"),t.arrtable.push(l.data.imageUrl));case 7:case"end":return a.stop()}},a,t)}))()},handleset:function(e){this.deviceId=e,this.imgBox=!0},handleRealTime:function(e){this.deviceId=e,this.getRealBox({id:e})&&(console.log(this.$store.state,this.cellList),this.realBox=!0)}}}),v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"equipmentList"}},[e._m(0),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("设备序号：")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.search.deviceid,callback:function(t){e.$set(e.search,"deviceid",t)},expression:"search.deviceid"}},[a("el-option",[e._v("未选择")]),e._v(" "),e._l(e.equipmentlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.deviceid,value:e.deviceid}})})],2)],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){e.addBox=!0,e.editBox=!1,e.clear()}}},[e._v("添加")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.handleSearchClick}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"设备序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.deviceid))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.deviceid))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设备名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.alias))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.alias))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(e._f("validate")(t.row.date)))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(e._f("validate")(t.row.date)))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"洗车机状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[1==t.row.succ?a("el-tag",{attrs:{color:"#f8c541"}},[e._v("应答成功")]):2==t.row.succ?a("el-tag",{attrs:{color:"#5daf34"}},[e._v("启动成功")]):0==t.row.succ?a("el-tag",{attrs:{color:"#f8c541"}},[e._v("洗车完毕")]):3==t.row.succ?a("el-tag",{attrs:{color:"#c9521e"}},[e._v("洗车故障")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"运行状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[1==t.row.run?a("el-tag",{attrs:{color:"#5daf34"}},[e._v("运行中")]):e._e(),e._v(" "),1!=t.row.run?a("el-tag",{attrs:{color:"#f8c541"}},[e._v("空闲")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("i",{staticClass:"icon-change el-icon-edit",on:{click:function(a){e.handleEditequipment(t.row)}}})]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"绑定摄像头",placement:"top"}},[a("i",{staticClass:"jilu iconfont icon-yuanchengkongzhi",on:{click:function(a){e.bind(t.row)}}})]),e._v(" "),t.row.bindcar.length>0?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解绑摄像头",placement:"top"}},[a("i",{staticClass:"jilu iconfont icon-bangding",on:{click:function(a){e.nobind(t.row)}}})]):e._e(),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(a){e.ClickDeleteequipment(t.row.id)}}})])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.editBox?"查看修改洗车机":"添加洗车机",visible:e.addBox},on:{"update:visible":function(t){e.addBox=t}}},[a("el-form",{ref:"equipment",attrs:{inline:!0,model:e.equipment,rules:e.rules}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备序号",prop:"deviceid"}},[a("el-input",{attrs:{disabled:e.editBox},model:{value:e.equipment.deviceid,callback:function(t){e.$set(e.equipment,"deviceid",t)},expression:"equipment.deviceid"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备名称",prop:"alias"}},[a("el-input",{model:{value:e.equipment.alias,callback:function(t){e.$set(e.equipment,"alias",t)},expression:"equipment.alias"}})],1)],1)],1),e._v(" "),e.editBox?a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"摄像头名称",prop:"alias"}},[a("el-select",{attrs:{placeholder:"请选择摄像头",disabled:"true"},model:{value:e.binddeviceid1,callback:function(t){e.binddeviceid1=t},expression:"binddeviceid1"}},e._l(e.bindcamera,function(e){return a("el-option",{key:e.carid,attrs:{label:e.name,value:e.carid}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}})],1):e._e(),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.addBox=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:function(t){e.editBox?e.ClickEditEquipment("equipment"):e.ClickAddEquipment("equipment")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"绑定摄像头",visible:e.universal1.bind},on:{"update:visible":function(t){e.$set(e.universal1,"bind",t)}}},[a("div",{staticClass:"totalcard"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.camera,height:"250"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"摄像头名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.alias))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"摄像头编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.deviceId))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"绑定",placement:"top"}},[a("i",{staticClass:"jilu iconfont icon-yuanchengkongzhi",on:{click:function(a){e.barrierclick(t.row.deviceId)}}})])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal1.bind=!1}}},[e._v("取消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"解绑摄像头",visible:e.universal1.nobind},on:{"update:visible":function(t){e.$set(e.universal1,"nobind",t)}}},[a("div",{staticClass:"totalcard"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.bindcamera,height:"250"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"摄像头名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"摄像头编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.carid))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解绑",placement:"top"}},[a("i",{staticClass:"jilu iconfont icon-bangding",on:{click:function(a){e.nobindclick(t.row.carid)}}})])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal1.nobind=!1}}},[e._v("取消")])],1)]),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,15,20],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"headerTitle"},[t("span",[this._v("洗车机管理")])])])}]};var g=a("VU/8")(f,v,!1,function(e){a("52hy")},"data-v-1da8ca28",null);t.default=g.exports},"52hy":function(e,t){}});