webpackJsonp([23],{"8sHf":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),o=a("exGp"),i=a.n(o),n=a("woOf"),l=a.n(n),c=a("Dd8w"),d=a.n(c),u=a("mw3O"),p=a.n(u),g=a("OMN4"),h=a.n(g),f=a("NYxO"),m=a("UMo0"),v={name:"parkingListBind",data:function(){return{showDialog:!1,universal:{change:!1,add1:!1},parkIist:[],tableDataadd:[],paging:{page:1,pageSize:10,total:""},tableData:[],search:{carNumber:"",ownerName:""},add1:{carportId:"",carNumber:"",ownerName:"",ownerTel:"",remark:""},parkingList:[],rules:{carportId:[{required:!0,message:"不能为空",trigger:"blur"}],carNumber:[{required:!0,message:"不能为空",trigger:"blur"}],ownerName:[{required:!0,message:"不能为空",trigger:"blur"}],ownerTel:[{required:!0,validator:function(e,t,a){""===t?a(new Error("手机号不能为空")):(/^1[3456789]\d{9}$/.test(t)||a(new Error("请输入正确的手机号")),a())},trigger:"blur"}]}}},computed:d()({},Object(f.e)(["use_statuslist","usage","tickettype","Distributing","disbursement","parkingname"]),Object(f.c)({parkingLotInfo:"getParkingLotInfo",parkingLotDevList:"getParkingLotDevList"})),mounted:function(){this.searchClick();var e=this,t={page:1,pageSize:100,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};this.getParkingLotListApiList(),Object(m._50)("/moreThanACar/selectCarPort",t).then(function(t){0==t.data.resCode?e.parkingList=t.data.result:e.parkingList=[]})},methods:{getParkingLotListApiList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(m._13)(t).then(function(t){console.log(t),e.parkIist=t.data.result})},changeclick:function(e){var t=this,a=this;this.$refs[e].validate(function(e){e&&(console.log(t.add1),delete t.add1.date,h()({method:"post",url:a.$store.state.url+"/moreThanACarParkBind/updateOwnerInfo",data:p.a.stringify(t.add1)}).then(function(e){console.log(e),0==e.data.code?(t.showDialog=!1,t.$message({message:"修改成功",type:"success"}),t.searchClick()):(t.showDialog=!1,t.$message({message:e.data.result,type:"error"}),t.searchClick())}))})},changeShow:function(e){this.universal.change=!0,this.universal.add1=!1,this.showDialog=!0,this.add1=l()({},e)},chose:function(e){for(var t=e.split(","),a=0;a<t.length;a++)for(var r=0;r<this.parkIist.length;r++){var s;if(t[a]==this.parkIist[r].parking_id)s=(s+=this.parkIist[r].parking_name+",").replace(/undefined/,"")}return console.log(s),s=void 0==s?"全部":s.slice(0,s.length-1)},choose:function(e){for(var t=0;t<this.parkingList.length;t++)e==this.parkingList[t].id&&(e=this.parkingList[t].carportName);return e},ADD:function(){this.universal.add1=!0,this.universal.change=!1,this.showDialog=!0,this.add1.carportId=Number(this.$route.query.id),this.add1.carNumber="",this.add1.ownerName="",this.add1.ownerTel="",this.add1.remark=""},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},handleSizeChange:function(e){this.paging.pageSize=e,this.searchClick()},handleCurrentChange:function(e){this.paging.page=e,this.searchClick()},addClick:function(e){var t=this,a=this;this.$refs[e].validate(function(e){e&&h()({method:"post",url:a.$store.state.url+"/moreThanACarParkBind/bindCarNumber",data:p.a.stringify(a.add1)}).then(function(e){console.log(e),0==e.data.code?(t.showDialog=!1,t.$message({message:"添加成功",type:"success"}),t.searchClick()):(t.showDialog=!1,t.$message({message:"添加失败",type:"error"}),t.searchClick())})})},deleteClick:function(e){var t=this;console.log(e);var a=this;this.$confirm("此操作将删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(s.a.mark(function r(){return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:h()({method:"post",url:a.$store.state.url+"/moreThanACarParkBind/deleteBindInfo",data:p.a.stringify({id:e.id})}).then(function(e){console.log(e),0==e.data.code?(t.$message({type:"success",message:"删除成功"}),a.searchClick()):(t.$message({type:"error",message:"删除失败"}),a.searchClick())});case 1:case"end":return r.stop()}},r,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})})},searchClick:function(){var e=this;return i()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=e,r={pageSize:e.paging.pageSize,page:e.paging.page,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer"),carportId:e.$route.query.id},e.search.carNumber&&(r.carNumber=e.search.carNumber),e.search.ownerName&&(r.ownerName=e.search.ownerName),h()({method:"post",url:a.$store.state.url+"/moreThanACarParkBind/selectBindInfo",data:p.a.stringify(r)}).then(function(e){console.log(e),0==e.data.resCode?(a.tableData=e.data.result,a.paging.total=e.data.count):(a.tableData=[],a.paging.total=0)});case 5:case"end":return t.stop()}},t,e)}))()}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"faultList"}},[a("div",{staticClass:"header"},[a("div",{staticClass:"headerTitle"},[a("span",[e._v(e._s(e.choose(this.$route.query.id))+"车位绑定列表")]),e._v(" "),a("el-button",{staticClass:"oyButton back",staticStyle:{float:"right"},attrs:{type:"success"},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("车牌号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.carNumber,callback:function(t){e.$set(e.search,"carNumber",t)},expression:"search.carNumber"}}),e._v(" "),a("span",[e._v("车主：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.ownerName,callback:function(t){e.$set(e.search,"ownerName",t)},expression:"search.ownerName"}})],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.ADD}},[e._v("添加")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"停车场名称",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(e.chose(t.row.parkingId)))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(e.chose(t.row.parkingId)))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车位编号",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(e.choose(t.row.carportId)))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(e.choose(t.row.carportId)))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车牌号",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.carNumber))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.carNumber))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车主",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.ownerName))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.ownerName))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.ownerTel))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.ownerTel))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"备注",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.remark))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.remark))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("i",{staticClass:"icon-change el-icon-edit",on:{click:function(a){e.changeShow(t.row)}}})]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(a){e.deleteClick(t.row)}}})])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.universal.add1?"添加":"修改",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[a("el-form",{ref:"add1",attrs:{inline:!0,model:e.add1,rules:e.rules}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车位编号:",prop:"carportId"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",disabled:!0},model:{value:e.add1.carportId,callback:function(t){e.$set(e.add1,"carportId",t)},expression:"add1.carportId"}},[a("el-option",{attrs:{label:"未选择"}}),e._v(" "),e._l(e.parkingList,function(e){return a("el-option",{key:e.id,attrs:{label:e.carportName,value:e.id}})})],2)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车牌号:",prop:"carNumber"}},[a("el-input",{model:{value:e.add1.carNumber,callback:function(t){e.$set(e.add1,"carNumber",t)},expression:"add1.carNumber"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车主:",prop:"ownerName"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.add1.ownerName,callback:function(t){e.$set(e.add1,"ownerName",t)},expression:"add1.ownerName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"手机号:",prop:"ownerTel"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.add1.ownerTel,callback:function(t){e.$set(e.add1,"ownerTel",t)},expression:"add1.ownerTel"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.add1.remark,callback:function(t){e.$set(e.add1,"remark",t)},expression:"add1.remark"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}})],1),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal.add1=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal.add1?e.addClick("add1"):e.changeclick("add1")}}},[e._v("确认")])],1)],1)],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,15,20],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[]};var b=a("VU/8")(v,w,!1,function(e){a("XgIt")},"data-v-edddd026",null);t.default=b.exports},XgIt:function(e,t){}});