webpackJsonp([69],{"S+fd":function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("Xxa5"),n=t.n(a),i=t("exGp"),r=t.n(i),o=t("Dd8w"),l=t.n(o),c=t("4s4v"),u=t("UMo0"),d=t("NYxO"),p={data:function(){return{addBussiness:!1,editBussiness:!1,bindEquipment:!1,deviceList:[],deviceid:"",formData:{bussinessName:"",userName:"",phone:"",washMod:"",account:"",password:"",address:""},rules:{bussinessName:[{required:!0,message:"请输入商户名称",trigger:"blur"}],userName:[{required:!0,message:"联系人姓名",trigger:"blur"}],phone:[{validator:c.b,trigger:"blur"},{required:!0,message:"不能为空",trigger:"blur"}],boxId:[{required:!0,message:"不能为空",trigger:"blur"}],jmoney:[{required:!0,message:"不能为空",trigger:"blur"}],pmoney:[{required:!0,message:"不能为空",trigger:"blur"}],washMod:[{required:!0,message:"不能为空",trigger:"blur"}],account:[{required:!0,message:"不能为空",trigger:"blur"}],password:[{required:!0,message:"不能为空",trigger:"blur"}],address:[{required:!0,message:"不能为空",trigger:"blur"}]},paging:{page:1,pageSize:10},search:{name:""},infoId:null,dealer:localStorage.getItem("dealer")}},computed:l()({},Object(d.c)({bussinessList:"getBussinessList",equipmentList:"getEquipmentList"}),Object(d.e)(["totalla"]),{bussinessInfo:function(){return console.log(this.$store.getters.getBussinessInfo(this.infoId)),this.$store.getters.getBussinessInfo(this.infoId)}}),mounted:function(){this.initEquipmentList(),this.handleSearchClick()},methods:l()({},Object(d.b)(["initBussinessList","searchBussinessList","updateBussiness","initEquipmentList","toBussinessBindDevice","initBindDeviceList"]),{handunbind:function(e){var s=this;return r()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),a={bid:e.eid,deviceid:e.deviceId},t.next=4,Object(u._38)(a);case 4:200==t.sent.status?s.$message({message:"解绑成功",type:"success"}):s.$message({message:"解绑失败",type:"error"});case 6:case"end":return t.stop()}},t,s)}))()},handleSizeChange:function(e){this.paging.pageSize=e,this.handleSearchClick()},handleCurrentChange:function(e){this.paging.page=e,this.handleSearchClick()},ClickAddBussiness:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return s.addBussiness=!1,s.$message({message:"添加失败",type:"error"}),!1;var t={name:s.formData.bussinessName,person:s.formData.userName,phone:s.formData.phone,typeId:s.formData.boxId,account:s.formData.account,password:s.formData.password,address:s.formData.address,dealer:localStorage.getItem("dealer")};Object(u.a)(t).then(function(e){s.addBussiness=!1,s.$message({message:"添加成功",type:"success"}),s.initBussinessList()})})},handleSearchClick:function(){var e={dealer:localStorage.getItem("dealer"),page:this.paging.page,pageSize:this.paging.pageSize,userId:localStorage.getItem("userId")};this.search.name&&(e.name=this.search.name),this.searchBussinessList(e)},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},ClickEditBussiness:function(e){var s=this;return r()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log(s.bussinessInfo),s.$refs[e].validate(function(e){if(!e)return s.addBussiness=!1,s.$message({message:"修改失败",type:"error"}),!1;var t={name:s.bussinessInfo.name,person:s.bussinessInfo.person,phone:s.bussinessInfo.phone,deviceId:s.bussinessInfo.deviceId,account:s.bussinessInfo.account,password:s.bussinessInfo.password,typeId:s.bussinessInfo.typeId,address:s.bussinessInfo.address,bid:s.bussinessInfo.bid};console.log(t),s.updateBussiness(t).then(function(e){console.log(e),s.addBussiness=!1,s.$message({message:"修改成功",type:"success"}),s.editBussiness=!1,s.initBussinessList()})});case 2:case"end":return t.stop()}},t,s)}))()},ClickbindEquipment:function(){var e=this;return r()(n.a.mark(function s(){return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e.toBussinessBindDevice({bid:e.infoId,deviceid:e.deviceid}).then(function(s){s?(e.$message({message:"绑定成功",type:"success"}),e.bindEquipment=!1):(e.$message({message:"绑定失败",type:"error"}),e.bindEquipment=!1)});case 1:case"end":return s.stop()}},s,e)}))()},handleBindDevice:function(e){var s=this;return r()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s.bindEquipment=!0,s.infoId=e,s.initBindDeviceList({bid:e}).then(function(e){console.log(e),s.deviceList=e.data.result});case 3:case"end":return t.stop()}},t,s)}))()}})},f={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"bussinessList"}},[e._m(0),e._v(" "),t("div",{staticClass:"select"},[t("span",[e._v("商家名称：")]),e._v(" "),t("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.name,callback:function(s){e.$set(e.search,"name",s)},expression:"search.name"}})],1),e._v(" "),t("div",{staticClass:"select"},[t("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(s){e.addBussiness=!0}}},[e._v("添加")]),e._v(" "),t("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.handleSearchClick}},[e._v("查询")])],1),e._v(" "),t("div",{staticClass:"Content"},[t("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.bussinessList}},[t("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{label:"商家地址"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[t("p",{staticClass:"TsMaxWidth"},[e._v(e._s(s.row.address))]),e._v(" "),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"overflowHide"},[e._v(e._s(s.row.address))])])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"商家电话"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[t("p",{staticClass:"TsMaxWidth"},[e._v(e._s(s.row.phone))]),e._v(" "),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"overflowHide"},[e._v(e._s(s.row.phone))])])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"商家姓名"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[t("p",{staticClass:"TsMaxWidth"},[e._v(e._s(s.row.name))]),e._v(" "),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"overflowHide"},[e._v(e._s(s.row.name))])])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[t("i",{staticClass:"icon-change el-icon-edit",on:{click:function(t){e.editBussiness=!0,e.infoId=s.row.bid}}})]),e._v(" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"绑定设备",placement:"top"}},[t("i",{staticClass:"icon-See el-icon-zoom-in",on:{click:function(t){e.handleBindDevice(s.row.bid)}}})])]}}])})],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"添加商家",visible:e.addBussiness},on:{"update:visible":function(s){e.addBussiness=s}}},[t("el-form",{ref:"formData",attrs:{inline:!0,model:e.formData,rules:e.rules}},[t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商家名称",prop:"bussinessName"}},[t("el-input",{model:{value:e.formData.bussinessName,callback:function(s){e.$set(e.formData,"bussinessName",s)},expression:"formData.bussinessName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商家地址",prop:"address"}},[t("el-input",{model:{value:e.formData.address,callback:function(s){e.$set(e.formData,"address",s)},expression:"formData.address"}})],1)],1)],1),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"联系人姓名",prop:"userName"}},[t("el-input",{model:{value:e.formData.userName,callback:function(s){e.$set(e.formData,"userName",s)},expression:"formData.userName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{model:{value:e.formData.phone,callback:function(s){e.$set(e.formData,"phone",s)},expression:"formData.phone"}})],1)],1)],1),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.formData.password,callback:function(s){e.$set(e.formData,"password",s)},expression:"formData.password"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"账户",prop:"account"}},[t("el-input",{model:{value:e.formData.account,callback:function(s){e.$set(e.formData,"account",s)},expression:"formData.account"}})],1)],1)],1),e._v(" "),t("el-row",{staticStyle:{"text-align":"right"}},[t("el-button",{on:{click:function(s){e.addBussiness=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"success"},on:{click:function(s){e.ClickAddBussiness("formData")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"查看/修改商家信息",visible:e.editBussiness},on:{"update:visible":function(s){e.editBussiness=s}}},[t("el-form",{ref:"bussinessInfo",attrs:{inline:!0,model:e._f("isundefined")(e.bussinessInfo),rules:e.rules}},[t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"商家名称",prop:"name"}},[t("el-input",{model:{value:e.bussinessInfo.name,callback:function(s){e.$set(e.bussinessInfo,"name",s)},expression:"bussinessInfo.name"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"联系人姓名",prop:"person"}},[t("el-input",{model:{value:e.bussinessInfo.person,callback:function(s){e.$set(e.bussinessInfo,"person",s)},expression:"bussinessInfo.person"}})],1)],1)],1),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{model:{value:e.bussinessInfo.phone,callback:function(s){e.$set(e.bussinessInfo,"phone",s)},expression:"bussinessInfo.phone"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.bussinessInfo.password,callback:function(s){e.$set(e.bussinessInfo,"password",s)},expression:"bussinessInfo.password"}})],1)],1)],1),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"账号",prop:"account"}},[t("el-input",{model:{value:e.bussinessInfo.account,callback:function(s){e.$set(e.bussinessInfo,"account",s)},expression:"bussinessInfo.account"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"地址",prop:"address"}},[t("el-input",{model:{value:e.bussinessInfo.address,callback:function(s){e.$set(e.bussinessInfo,"address",s)},expression:"bussinessInfo.address"}})],1)],1)],1),e._v(" "),t("el-row",{staticStyle:{"text-align":"right"}},[t("el-button",{on:{click:function(s){e.editBussiness=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"success"},on:{click:function(s){e.ClickEditBussiness("bussinessInfo")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"商家绑定设备",visible:e.bindEquipment},on:{"update:visible":function(s){e.bindEquipment=s}}},[t("div",{staticClass:"blind"},[e._v("已绑定设备")]),e._v(" "),t("div",{staticClass:"blindDiv"},[t("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.deviceList}},[t("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{label:"钥匙柜名称"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[t("p",{staticClass:"TsMaxWidth"},[e._v(e._s(s.row.codestyle))]),e._v(" "),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"overflowHide"},[e._v(e._s(s.row.codestyle))])])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"钥匙柜格式"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[t("p",{staticClass:"TsMaxWidth"},[e._v(e._s(s.row.cabinet))]),e._v(" "),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"overflowHide"},[e._v(e._s(s.row.cabinet))])])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"钥匙柜编号"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[t("p",{staticClass:"TsMaxWidth"},[e._v(e._s(s.row.deviceId))]),e._v(" "),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t("div",{staticClass:"overflowHide"},[e._v(e._s(s.row.deviceId))])])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"解绑",placement:"top"}},[t("i",{staticClass:"icon-See el-icon-remove-outline",on:{click:function(t){e.handunbind(s.row)}}})])]}}])})],1)],1),e._v(" "),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.deviceid,callback:function(s){e.deviceid=s},expression:"deviceid"}},[t("el-option",{key:"",attrs:{value:"",label:"未选择"}}),e._v(" "),e._l(e.equipmentList.list,function(e){return t("el-option",{key:e.deviceId,attrs:{label:e.codestyle,value:e.deviceId}})})],2),e._v(" "),t("el-row",{staticStyle:{"text-align":"right"}},[t("el-button",{on:{click:function(s){e.bindEquipment=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"success"},on:{click:function(s){e.ClickbindEquipment()}}},[e._v("确 定")])],1)],1),e._v(" "),t("div",{staticClass:"footer"},[t("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[1,2,3,10,11,12],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.totalla},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(s){e.$set(e.paging,"page",s)}}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"header"},[s("div",{staticClass:"headerTitle"},[s("span",[this._v("商家管理")])])])}]};var m=t("VU/8")(p,f,!1,function(e){t("sWgU")},"data-v-388eea0d",null);s.default=m.exports},sWgU:function(e,s){}});