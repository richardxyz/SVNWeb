webpackJsonp([27],{yrOi:function(t,e){},yx4X:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mtWM"),r=a.n(i),s=a("mw3O"),o=a.n(s),n=a("Au9i"),c={data:function(){return{useMark:"",markmoney:!1,a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",k:"",y:"",appId:"",loack:"",timeStamp:"",nonceStr:"",package:"",signType:"",paySign:"",ticketNumber:"",disp:"",isTicket:"",numji:"",type:"",moneys:"",tradeNo:""}},mounted:function(){this.$route.query.val&&(this.markmoney=!0),this.a=localStorage.getItem("carnumber"),this.b=localStorage.getItem("longdate"),this.c=localStorage.getItem("onsale_price"),this.d=localStorage.getItem("paid_price"),this.e=localStorage.getItem("paking_lot_name"),this.f=localStorage.getItem("price"),this.g=localStorage.getItem("startdate"),this.h=localStorage.getItem("time_out"),this.k=localStorage.getItem("HPrice"),this.y=(Number(this.f)+Number(this.c)).toFixed(2),console.log(this.e),console.log(sessionStorage.getItem("ticknumbar2")),console.log(sessionStorage.getItem("ticknumbar3")),sessionStorage.getItem("ticknumbar1")&&0==sessionStorage.getItem("ticknumbar2")?(this.loack=2,this.disp=sessionStorage.getItem("ticknumbar1")):sessionStorage.getItem("ticknumbar4")?(this.loack=4,this.disp=sessionStorage.getItem("ticknumbar4")/10):(this.loack=3,this.disp=sessionStorage.getItem("ticknumbar2"),sessionStorage.getItem("ticknumbar2")||(this.loack=1));var t=this;t.$http({method:"post",url:t.httpUrl+"/MarkRecords/findMark",data:o.a.stringify({tel:localStorage.getItem("phone")})}).then(function(e){0==e.data.resCode?t.numji=e.data.result:t.numji=0}).catch(function(e){t.numji=0})},beforeCreate:function(){console.log(18),r.a.get(this.httpUrl+"/User/getSignture?url="+window.location.href.split("#")[0]).then(function(t){console.log(t),wx.config({debug:!1,appId:t.data.appid,timestamp:t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["chooseWXPay"]}),console.log(111)})},methods:{duihuan:function(){this.$router.push("/shengcheng")},tica:function(){this.$router.push({path:"/discount",query:{num:6,val:7}})},rightnow:function(){var t=this,e={},a=localStorage.getItem("openid");sessionStorage.getItem("ticknumbar3")&&this.$route.query.valmark&&(this.type=3,e={type:3,openId:a,money:this.f,carNumber:this.a,ip:returnCitySN.cip,mark:this.$route.query.valmark,ticketNumber:sessionStorage.getItem("ticknumbar3"),start:this.g}),sessionStorage.getItem("ticknumbar3")||this.$route.query.valmark?sessionStorage.getItem("ticknumbar3")?this.$route.query.valmark||(this.type=1,e={type:1,openId:a,money:this.f,carNumber:this.a,ip:returnCitySN.cip,ticketNumber:sessionStorage.getItem("ticknumbar3"),start:this.g,mark:0}):0!=this.$route.query.valmark&&(this.type=2,e={type:2,openId:a,money:this.f,carNumber:this.a,ip:returnCitySN.cip,mark:this.$route.query.valmark,start:this.g}):(this.type=0,e={type:0,money:this.f,openId:a,carNumber:this.a,ip:returnCitySN.cip,start:this.g,mark:0}),console.log(e);var i=this;i.$http({method:"post",url:i.oldurl+"/web/parkingPay/pay",data:o.a.stringify(e)}).then(function(e){console.log(e),i.tradeNo=e.data.result.tradeNo,0==e.data.resCode?(e.data.result.useMark&&(i.useMark=e.data.result.useMark),i.moneys=e.data.result.money,i.appId=e.data.result.appId,i.timeStamp=e.data.result.timeStamp,i.nonceStr=e.data.result.nonceStr,i.package=e.data.result.package,i.signType=e.data.result.signType,i.paySign=e.data.result.paySign,0==e.data.result.price||e.data.result.price<0?i.$http({method:"post",url:i.oldurl+"/web/parkingPay/afterPay",data:o.a.stringify({parkingId:localStorage.getItem("parkingId"),carNumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:i.useMark,openId:localStorage.getItem("openid"),type:i.type,money:0,resId:i.tradeNo})}).then(function(t){Object(n.MessageBox)({title:"提示",message:"本次停车免费",closeOnClickModal:!1}).then(function(t){r()({method:"post",url:i.httpUrl+"app/reserve/selectResId",data:o.a.stringify({resId:i.$route.query.orderg})}).then(function(t){console.log(t)}),i.$router.replace({path:"/list"})})}):wx.ready(function(){wx.chooseWXPay({timestamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(t){"chooseWXPay:ok"!==t.errMsg&&"getBrandWCPayRequest:ok"!=t.errMsg||(n.Indicator.open("Loading..."),i.polling())},fail:function(t){this.$route.query.val="",this.markmoney=!1,Object(n.MessageBox)("提示","支付失败")},complete:function(t){}})})):1==e.data.resCode?i.$http({method:"post",url:i.oldurl+"/web/parkingPay/afterPay",data:o.a.stringify({parkingId:localStorage.getItem("parkingId"),carNumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:i.useMark,openId:localStorage.getItem("openid"),type:i.type,money:0,resId:i.tradeNo})}).then(function(t){Object(n.MessageBox)({title:"提示",message:"本次停车免费",closeOnClickModal:!1}).then(function(t){r()({method:"post",url:i.httpUrl+"app/reserve/selectResId",data:o.a.stringify({resId:i.$route.query.orderg})}).then(function(t){console.log(t)}),i.$router.push({path:"/list"})})}):2==e.data.resCode?(t.markmoney=!1,Object(n.MessageBox)({title:"提示",message:"本次停车免费",closeOnClickModal:!1}).then(function(t){i.$router.push({path:"/list"}),sessionStorage.clear("ticknumbar1"),sessionStorage.clear("ticknumbar2"),sessionStorage.clear("ticknumbar3")})):10==e.data.resCode&&(t.markmoney=!1,Object(n.MessageBox)({title:"提示",message:e.data.result,closeOnClickModal:!1}).then(function(t){sessionStorage.clear("ticknumbar1"),sessionStorage.clear("ticknumbar2"),sessionStorage.clear("ticknumbar3")}))})},polling:function(){this.useMark||(this.useMark=0);var t=this;t.$http({method:"post",url:t.oldurl+"/web/parkingPay/afterPay",data:o.a.stringify({parkingId:localStorage.getItem("parkingId"),carNumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:t.useMark,type:t.type,openId:localStorage.getItem("openid"),money:t.moneys,resId:t.tradeNo})}).then(function(e){r()({method:"post",url:t.httpUrl+"app/reserve/selectResId",data:o.a.stringify({resId:t.$route.query.orderg})}).then(function(t){console.log(t)}),n.Indicator.close(),t.$router.replace({path:"/list"})})},getFormatDate:function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},onBridgeReady:function(){var t=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg&&t.$http({method:"post",url:t.oldurl+"/web/parkingPay/afterPay",data:o.a.stringify({parkingId:localStorage.getItem("parkingId"),carNumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:t.$route.query.valmark,type:t.type,openId:localStorage.getItem("openid"),money:t.moneys})}).then(function(e){r()({method:"post",url:t.httpUrl+"app/reserve/selectResId",data:o.a.stringify({resId:t.$route.query.orderg})}).then(function(t){console.log(t)}),t.$router.replace({path:"/return"})})})}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%",background:"#fff"}},[i("div",{staticStyle:{width:"96%",margin:"0 auto","line-height":"0.4rem","text-align":"center","padding-top":"0.22rem"}},[i("p",{staticStyle:{"font-size":"20px"}},[t._v(t._s(t.e))]),t._v(" "),i("p",{staticStyle:{"font-size":"25px",color:"#f68b1c"}},[t._v(t._s(t.y>=0?t.y:0)+"元")]),t._v(" "),i("p",{staticStyle:{"font-size":"13px",color:"#999"}},[t._v("车口袋提供计时服务")])]),t._v(" "),i("div",{staticStyle:{background:"#e6e6e6",height:"0.13rem",width:"100%"}}),t._v(" "),i("ul",{staticClass:"payul"},[i("li",[i("div",{staticStyle:{}},[t._v("车牌号码")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.a))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("预约时间")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.g))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("预约时长")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.b))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("停车单价")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.k)+"元/小时")])]),t._v(" "),i("li",{staticStyle:{background:"#e6e6e6",height:"0.13rem",width:"100%","margin-left":"0"}}),t._v(" "),i("li",{staticClass:"meiyong"},[i("div",{staticStyle:{}},[t._v("应付金额")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v("￥"+t._s(t.f))])]),t._v(" "),i("li",{staticClass:"meiyong",on:{click:t.tica}},[i("div",{staticStyle:{}},[t._v("优惠券")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[1==t.loack?i("span",[t._v("优惠券")]):t._e(),t._v(" "),2==t.loack?i("span",[t._v("免费时长"+t._s(t.disp)+"分钟")]):t._e(),t._v(" "),3==t.loack?i("span",[t._v("红包优惠"+t._s(t.disp)+"元")]):t._e(),t._v(" "),4==t.loack?i("span",[t._v("红包折扣"+t._s(t.disp)+"折")]):t._e(),t._v(" "),i("img",{staticStyle:{"vertical-align":"middle","margin-top":"-2px","margin-right":"-2px",width:"0.07rem",height:"0.12rem"},attrs:{src:a("LIqU")}})])]),t._v(" "),i("router-link",{attrs:{to:"/shengcheng"}},[i("li",{staticClass:"meiyong"},[i("div",{staticStyle:{}},[t._v("积分抵扣")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t.markmoney?i("span",[t._v("积分抵扣"+t._s(this.$route.query.val)+"元")]):t._e(),t._v(" "),t.markmoney?t._e():i("span"),t._v(" "),i("img",{staticStyle:{"vertical-align":"middle","margin-top":"-2px","margin-right":"-2px",width:"0.07rem",height:"0.12rem"},attrs:{src:a("LIqU")}})])])]),t._v(" "),i("li",{staticClass:"meiyong"},[i("div",{staticStyle:{}},[t._v("优惠金额")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v("￥"+t._s(t.c))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("已付金额")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v("￥"+t._s(t.d))])])],1),t._v(" "),i("div",{staticStyle:{width:"92%",margin:"0 auto","font-size":"14px",color:"#b9b9b9","margin-top":"0.1rem","margin-bottom":"0.03rem"}},[t._m(0),t._v(" "),i("span",{staticStyle:{color:"#999","font-size":"11px"}},[t._v("请于付款后\n      "),i("span",[t._v(t._s(t.h))]),t._v("分钟离场，超时将加收停车费")])]),t._v(" "),i("div",{staticClass:"paytoot",on:{click:t.rightnow}},[t._v("立即付款")])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticStyle:{"vertical-align":"middle",width:"0.15rem",height:"0.15rem",display:"inline-block"}},[e("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:a("dIaG"),alt:""}})])}]};var g=a("VU/8")(c,l,!1,function(t){a("yrOi")},"data-v-094c623e",null);e.default=g.exports}});