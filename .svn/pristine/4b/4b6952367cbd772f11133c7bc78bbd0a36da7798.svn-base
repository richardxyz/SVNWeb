webpackJsonp([70],{"1Da4":function(e,t){},g0j4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),r=a.n(s),l=a("woOf"),o=a.n(l),n=a("mw3O"),i=a.n(n),c=a("OMN4"),d=a.n(c),p=(a("NYxO"),a("UMo0")),u={name:"washRecord",data:function(){return{paging:{page:1,pageSize:10,total:0},tableData:[],gameNum:[],search:{carShopId:"",relName:"",orderId:"",tel:"",carNumber:""},parkIist:[],shopList:[],universal:{look:!1,change:!1},look:{},stafftype:[{typePerson:0,label:"不是员工"},{typePerson:1,label:"销售员"},{typePerson:2,label:"售后员"},{typePerson:3,label:"其他员工"}],change:{orderId:"",refundFee:"",refundReason:"",refundType:2,userId:"",dealer:"",shopName:"",totalFee:"",type:1}}},mounted:function(){document.title=this.$route.meta.title,this.searchClick(),this.getwashsiteList(),this.getshopList()},computed:{},methods:{getwashsiteList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(p._24)(t).then(function(t){if(console.log(t),t.data.result.length>0){for(var a=0;a<t.data.result.length;a++){var s={sid:t.data.result[a].sid,sname:t.data.result[a].sname};e.parkIist.push(s)}console.log(e.parkIist)}else e.parkIist=[]})},getshopList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(p._27)(t).then(function(t){if(console.log(t),t.data.count>0){for(var a=0;a<t.data.count;a++){var s={id:t.data.result[a].id,shopName:t.data.result[a].shopName};e.shopList.push(s)}console.log(e.shopList)}else e.shopList=[]})},chosesname:function(e){return this.parkIist.forEach(function(t,a){t.sid==e&&(e=t.sname)}),e},chosestafftype:function(e){return this.stafftype.forEach(function(t,a){t.typePerson==e&&(e=t.label)}),e},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},handleSizeChange:function(e){this.paging.pageSize=e,this.searchClick()},handleCurrentChange:function(e){this.paging.page=e,this.searchClick()},seeClick:function(e){this.universal.look=!0,o()(this.look,e)},endOrder:function(e){var t=this;console.log(e);var a=this;this.$confirm("是否结算订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){d()({method:"post",url:a.$store.state.wash_url+"/carShopWashRecords/exWashStatus",data:i.a.stringify({id:e})}).then(function(e){console.log(e.data),0==e.data.resCode?(a.$message({message:"结算成功",type:"success"}),a.searchClick()):a.$message({message:"结算失败",type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消结算订单"})})},deleteClick:function(e){var t=this;console.log(e);var a=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(p.R)({id:e.id}).then(function(e){console.log(e.data),0==e.data.resCode?(a.$message({message:"删除成功",type:"success"}),a.searchClick()):a.$message({message:"删除失败",type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},searchClick:function(){var e=this,t={page:this.paging.page,pageSize:this.paging.pageSize,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};this.search.orderId&&(t.orderId=this.search.orderId),this.search.relName&&(t.relName=this.search.relName),this.search.tel&&(t.tel=this.search.tel),this.search.carNumber&&(t.carNumber=this.search.carNumber),e.tableData=[],Object(p._26)(t).then(function(t){if(console.log(t.data),0==t.data.resCode){e.gameNum=t.data.result,e.paging.total=t.data.count;for(var a=e.paging.pageSize*(e.paging.page-1);a<e.paging.pageSize*e.paging.page;a++)e.gameNum[a]&&e.tableData.push(e.gameNum[a]);console.log(e.gameNum),console.log(e.tableData)}else e.tableData=[],e.paging.total=0})},tmoenypay:function(e){console.log(e),this.change.orderId=e.orderId,this.change.shopName=e.shopName,this.change.totalFee=e.paidPrice,this.change.refundFee="",this.change.refundReason="",this.change.userId=sessionStorage.getItem("userAlias"),this.change.dealer=localStorage.getItem("dealer"),(this.change.refundType=2)&&(this.change.refundType="微信支付"),this.universal.change=!0},paychange:function(){if(""==this.change.refundFee||""==this.change.refundReason||0==this.change.refundFee)return this.$message.error("退款金额和理由不能为空"),!1;if(isNaN(this.change.refundFee))return this.$message.error("退款金额为数字"),!1;if(this.change.refundFee>this.change.totalFee)return this.$message.error("退款金额不能大于总金额"),!1;"微信支付"==this.change.refundType?this.change.refundType=2:"支付宝支付"==this.change.refundType?this.change.refundType=1:"现金支付"==this.change.refundType&&(this.change.refundType=3),console.log(this.change);var e=this;d()({method:"post",url:e.$store.state.wash_url+"/refundpayWashcar/exRefund",data:i.a.stringify(e.change)}).then(function(t){console.log(t),0==t.data.resCode?(e.$message({message:"退款成功",type:"success"}),e.searchClick()):1==t.data.resCode?e.$message({message:t.data.result,type:"error"}):e.$message({message:"退款失败",type:"error"}),e.universal.change=!1})},validate:function(e){var t=r()(e.time).slice(0,10),a=new Date(1e3*t),s=a.getFullYear(),l=a.getMonth()+1,o=a.getDate(),n=a.getHours(),i=a.getMinutes(),c=a.getSeconds();return s+"-"+this.add(l)+"-"+this.add(o)+" "+this.add(n)+":"+this.add(i)+":"+this.add(c)},add:function(e){return e<10?"0"+e:e}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"faultList"}},[a("div",{staticClass:"header"},[a("div",{staticClass:"headerTitle"},[a("router-link",{attrs:{to:"/pageHome/washRecord",tag:"span"}},[e._v("洗车记录")]),e._v(" "),a("router-link",{staticClass:"router-link-active",attrs:{to:"/pageHome/staffwashRecord",tag:"span"}},[e._v("员工洗车记录")])],1)]),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("订单号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.orderId,callback:function(t){e.$set(e.search,"orderId",t)},expression:"search.orderId"}}),e._v(" "),a("span",[e._v("姓名：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.relName,callback:function(t){e.$set(e.search,"relName",t)},expression:"search.relName"}}),e._v(" "),a("span",[e._v("手机号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.tel,callback:function(t){e.$set(e.search,"tel",t)},expression:"search.tel"}})],1),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("车牌号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.carNumber,callback:function(t){e.$set(e.search,"carNumber",t)},expression:"search.carNumber"}})],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"订单号",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.orderId))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.orderId))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"店铺名称",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.shopName))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.shopName))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.relName))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.relName))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.tel))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.tel))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"员工类型",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(e.chosestafftype(t.row.typePerson)))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(e.chosestafftype(t.row.typePerson)))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车牌号",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.carNumber))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.carNumber))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"洗车模式",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(1==t.row.typeWashCar?"精洗":"普洗"))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(1==t.row.typeWashCar?"精洗":"普洗"))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"实付金额",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.paidPrice)+"元")]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.paidPrice)+"元")])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"支付类型",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(1==t.row.payType?"微信":2==t.row.payType?"微信 + 券":"会员卡"))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(1==t.row.payType?"微信":2==t.row.payType?"微信 + 券":"会员卡"))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"券码",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.ticketNumber))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.ticketNumber))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"洗车状态",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(1==t.row.washcarStatus?"待洗车":2==t.row.washcarStatus?"洗车中":3==t.row.washcarStatus?"紧急停止":"洗车完成"))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(1==t.row.washcarStatus?"待洗车":2==t.row.washcarStatus?"洗车中":3==t.row.washcarStatus?"紧急停止":"洗车完成"))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单状态",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(1==t.row.orderStatus?"待支付":0==t.row.orderStatus?"已支付":"已退款"))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(1==t.row.orderStatus?"待支付":0==t.row.orderStatus?"已支付":"已退款"))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看",placement:"top"}},[a("i",{staticClass:"icon-See el-icon-document",on:{click:function(a){e.seeClick(t.row)}}})]),e._v(" "),0!=t.row.orderStatus||0==t.row.paidPrice?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"退款",placement:"top"}},[a("i",{staticClass:"jilu jilus iconfont icon-tuikuan"})]):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"退款",placement:"top"}},[a("i",{staticClass:"jilu iconfont icon-tuikuan",on:{click:function(a){e.tmoenypay(t.row)}}})]),e._v(" "),0==t.row.washcarStatus?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"结算订单",placement:"top"}},[a("i",{staticClass:"icon-unclick el-icon-service el-tooltip item"})]):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"结算订单",placement:"top"}},[a("i",{staticClass:"icon-change el-icon-service el-tooltip item",on:{click:function(a){e.endOrder(t.row.id)}}})]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(a){e.deleteClick(t.row)}}})])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"查看",visible:e.universal.look},on:{"update:visible":function(t){e.$set(e.universal,"look",t)}}},[a("div",{staticClass:"letg"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("订单号码：")]),e._v("\n          "+e._s(e.look.orderId)+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("店铺名称：")]),e._v("\n          "+e._s(e.look.shopName)+"\n        ")])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("姓名：")]),e._v("\n          "+e._s(e.chosestafftype(e.look.relName))+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("手机号：")]),e._v("\n          "+e._s(e.look.tel)+"\n        ")])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("员工类型：")]),e._v("\n          "+e._s(e.chosestafftype(e.look.typePerson))+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("车牌号：")]),e._v("\n          "+e._s(e.look.carNumber)+"\n        ")])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("洗车模式：")]),e._v("\n          "+e._s(1==e.look.typeWashCar?"精洗":"普洗")+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("支付类型：")]),e._v("\n          "+e._s(1==e.look.payType?"微信":2==e.look.payType?"微信 + 券":"会员卡")+"\n        ")])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("券码：")]),e._v(" "),a("div",[e._v(e._s(e.look.ticketNumber))])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("应付金额：")]),e._v(" "),a("div",[e._v(e._s(e.look.price)+"元")])])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("优惠金额：")]),e._v(" "),a("div",[e._v(e._s(e.look.onsalePrice)+"元")])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("实付金额：")]),e._v(" "),a("div",[e._v(e._s(e.look.paidPrice)+"元")])])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("洗车状态：")]),e._v(" "),a("div",[e._v(e._s(1==e.look.washcarStatus?"待洗车":2==e.look.washcarStatus?"洗车中":3==e.look.washcarStatus?"紧急停止":"洗车完成"))])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[e._v("订单状态：")]),e._v(" "),a("div",[e._v(e._s(1==e.look.orderStatus?"待支付":0==e.look.orderStatus?"已支付":"已退款"))])])],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"退款",visible:e.universal.change},on:{"update:visible":function(t){e.$set(e.universal,"change",t)}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"spanClass"},[e._v("订单号：")]),e._v(" "),a("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:e.change.orderId,callback:function(t){e.$set(e.change,"orderId",t)},expression:"change.orderId"}}),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClass"},[e._v("支付类型：")]),e._v(" "),a("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:e.change.refundType,callback:function(t){e.$set(e.change,"refundType",t)},expression:"change.refundType"}}),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClass"},[e._v("店铺名称：")]),e._v(" "),a("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:e.change.shopName,callback:function(t){e.$set(e.change,"shopName",t)},expression:"change.shopName"}}),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClass"},[e._v("实付金额：")]),e._v(" "),a("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:e.change.totalFee,callback:function(t){e.$set(e.change,"totalFee",t)},expression:"change.totalFee"}}),e._v(" 元"),a("br"),a("br")],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"spanClass"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("退款金额：")]),e._v(" "),a("el-input",{attrs:{disabled:!1,clearable:"",placeholder:"请输入内容"},model:{value:e.change.refundFee,callback:function(t){e.$set(e.change,"refundFee",t)},expression:"change.refundFee"}}),e._v(" 元"),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClass"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("退款理由：")]),e._v(" "),a("el-input",{staticClass:"textareaWidth",attrs:{type:"textarea",rows:5,clearable:"",placeholder:"请输入内容"},model:{value:e.change.refundReason,callback:function(t){e.$set(e.change,"refundReason",t)},expression:"change.refundReason"}}),a("br"),a("br")],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal.change=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.paychange}},[e._v("确认")])],1)],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,15,20],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[]};var h=a("VU/8")(u,v,!1,function(e){a("1Da4")},"data-v-37dfa237",null);t.default=h.exports}});