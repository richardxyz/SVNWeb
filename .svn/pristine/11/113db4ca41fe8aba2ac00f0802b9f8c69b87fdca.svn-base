webpackJsonp([21],{OgvM:function(t,e){},mTUd:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("bOdI"),r=a.n(i),s=a("mtWM"),o=a.n(s),n=a("mw3O"),c=a.n(n),g=a("Au9i"),l={data:function(){var t;return t={trade_no:"",markmoney:!1,a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",y:"",img:"",k:"",appId:"",loack:"",timeStamp:"",nonceStr:"",package:"",signType:"",paySign:"",ticketNumber:"",disp:"",isTicket:"",numji:"",isOrdered:"",longTime:"",onsale:""},r()(t,"trade_no",""),r()(t,"useMark",""),t},watch:{},mounted:function(){this.$route.query.val&&(this.markmoney=!0),this.a=localStorage.getItem("carnumber"),this.b=localStorage.getItem("longdate"),console.log(this.b),this.c=localStorage.getItem("onsale_price"),this.d=localStorage.getItem("paid_price"),this.e=localStorage.getItem("paking_lot_name"),this.f=localStorage.getItem("price"),this.g=localStorage.getItem("startdate"),this.h=localStorage.getItem("time_out"),this.img=localStorage.getItem("img"),this.k=localStorage.getItem("HPrice"),this.i=localStorage.getItem("priceUnit"),this.y=Number(this.f)+Number(this.c),console.log(sessionStorage.getItem("ticknumbar1")),console.log(sessionStorage.getItem("ticknumbar2")),console.log(sessionStorage.getItem("ticknumbar3")),sessionStorage.getItem("ticknumbar1")&&0==sessionStorage.getItem("ticknumbar2")?(this.loack=2,this.disp=sessionStorage.getItem("ticknumbar1")):sessionStorage.getItem("ticknumbar4")?(this.loack=4,this.disp=sessionStorage.getItem("ticknumbar4")/10):(this.loack=3,this.disp=sessionStorage.getItem("ticknumbar2"),sessionStorage.getItem("ticknumbar2")||(this.loack=1),console.log(this.disp),console.log(this.y)),console.log(this.y)},beforeCreate:function(){console.log(18),o.a.get(this.httpUrl+"/User/getSignture?url="+window.location.href.split("#")[0]).then(function(t){console.log(t),wx.config({debug:!1,appId:t.data.appid,timestamp:t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["chooseWXPay"]}),console.log(111)})},methods:{deduction:function(){this.$router.push({path:"/shengcheng",query:{recognition:5}})},duihuan:function(){this.$router.push("/shengcheng")},tica:function(){this.$router.push({path:"/discount",query:{num:6,val:8}})},rightnow:function(){console.log(sessionStorage.getItem("ticknumbar3"));var t={},e=this.openid;t=sessionStorage.getItem("ticknumbar3")||this.$route.query.valmark?sessionStorage.getItem("ticknumbar3")?{useType:1,openId:e,car_number:this.a,ip:returnCitySN.cip,ticketNumber:sessionStorage.getItem("ticknumbar3"),mark:0}:0!=this.$route.query.valmark?{useType:2,openId:e,car_number:this.a,ip:returnCitySN.cip,mark:this.$route.query.valmark,tel:localStorage.getItem("phone")}:{useType:0,openId:e,car_number:this.a,ip:returnCitySN.cip,mark:0}:{useType:0,openId:e,car_number:this.a,ip:returnCitySN.cip,mark:0},sessionStorage.getItem("ticknumbar3")&&this.$route.query.valmark&&(t={useType:3,openId:e,car_number:this.a,ip:returnCitySN.cip,mark:this.$route.query.valmark,ticketNumber:sessionStorage.getItem("ticknumbar3")});var a=this;a.$http({method:"post",url:a.httpUrl+"/Park/pay",data:c.a.stringify(t)}).then(function(t){console.log(t),t.data.msg.useMark&&(a.useMark=t.data.msg.useMark),t.data.money&&(a.moneys=t.data.money.toFixed(2)),console.log(a.moneys),a.isOrdered=t.data.msg.isOrdered,a.longTime=t.data.msg.longTime,a.onsale=t.data.msg.onsale,0==t.data.resCode?(t.data.money<=0&&a.$http({method:"post",url:a.httpUrl+"/Park/recvStatus",data:c.a.stringify({pay_status:"get_brand_wcpay_request:ok",pay_time:a.getFormatDate(),carnumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:a.useMark?a.useMark:0,openId:localStorage.getItem("openid"),price:0,longdate:a.b,isOrdered:a.isOrdered,onsale_price:a.onsale})}).then(function(t){Object(g.MessageBox)({title:"提示",message:"本次停车免费",closeOnClickModal:!1}).then(function(t){a.$router.push({path:"/list"})})}),a.appId=t.data.appId,a.timeStamp=t.data.timeStamp,a.nonceStr=t.data.nonceStr,a.package=t.data.package,a.signType=t.data.signType,a.paySign=t.data.paySign,a.trade_no=t.data.tradeNo,wx.ready(function(){wx.chooseWXPay({timestamp:a.timeStamp,nonceStr:a.nonceStr,package:a.package,signType:a.signType,paySign:a.paySign,success:function(t){"chooseWXPay:ok"!==t.errMsg&&"getBrandWCPayRequest:ok"!=t.errMsg||(g.Indicator.open("Loading..."),a.polling())},fail:function(t){this.markmoney=!1,Object(g.MessageBox)("提示","支付失败")},complete:function(t){}})})):2==t.data.resCode?(a.markmoney=!1,Object(g.MessageBox)({title:"提示",message:t.data.result,closeOnClickModal:!1}).then(function(t){a.$router.push({path:"/pay"}),sessionStorage.removeItem("ticknumbar1"),sessionStorage.removeItem("ticknumbar2"),sessionStorage.removeItem("ticknumbar3")})):1==t.data.resCode&&a.$http({method:"post",url:a.httpUrl+"/Park/recvStatus",data:c.a.stringify({pay_status:"get_brand_wcpay_request:ok",pay_time:a.getFormatDate(),carnumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:a.useMark?a.useMark:0,openId:localStorage.getItem("openid"),price:0,longdate:a.b,isOrdered:a.isOrdered,onsale_price:a.onsale})}).then(function(t){Object(g.MessageBox)({title:"提示",message:"本次停车免费",closeOnClickModal:!1}).then(function(t){a.$router.push({path:"/list"})})})})},licektl:function(){var t={carNumber:localStorage.getItem("carnumber")};console.log(t),this.$http({method:"post",url:this.oldurl+"/web/parkingPay/charging",data:c.a.stringify(t)}).then(function(t){1!=t.data.resCode&&(console.log(t),localStorage.setItem("carnumber",t.data.result.carnumber),localStorage.setItem("longdate",t.data.result.longdate),localStorage.setItem("onsale_price",t.data.result.onsale_price),localStorage.setItem("paid_price",t.data.result.paid_price),localStorage.setItem("paking_lot_name",t.data.result.paking_lot_name),localStorage.setItem("price",t.data.result.price),localStorage.setItem("startdate",t.data.result.startdate),localStorage.setItem("time_out",t.data.result.time_out),localStorage.setItem("parkingId",t.data.result.parkingId),localStorage.setItem("HPrice",t.data.result.HPrice),window.location.reload())})},polling:function(){var t=this;this.useMark||(this.useMark=0),this.$http({method:"post",url:this.httpUrl+"/Park/recvStatus",data:c.a.stringify({pay_status:"get_brand_wcpay_request:ok",pay_time:this.getFormatDate(),carnumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:this.useMark,openId:localStorage.getItem("openid"),price:this.moneys,longdate:this.b,isOrdered:this.isOrdered,onsale_price:this.onsale,out_trade_no:this.trade_no})}).then(function(e){g.Indicator.close(),t.$router.replace({path:"/return"})})},getFormatDate:function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},onBridgeReady:function(){var t=this;void 0==t.$route.query.valmark&&(t.$route.query.valmark=0),WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg&&t.$http({method:"post",url:t.httpUrl+"/Park/recvStatus",data:c.a.stringify({pay_status:e.err_msg,pay_time:t.getFormatDate(),carnumber:localStorage.getItem("carnumber"),ticketNumber:sessionStorage.getItem("ticknumbar3")?sessionStorage.getItem("ticknumbar3"):null,mark:t.useMark,openId:localStorage.getItem("openid"),price:t.moneys,longdate:t.b,isOrdered:t.isOrdered,onsale_price:t.onsale,out_trade_no:t.trade_no})}).then(function(e){t.$router.push({path:"/return"})})})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%",background:"#fff"}},[i("div",{staticClass:"table",style:{backgroundImage:"url("+t.img+")",backgroundSize:"100% 100%"}},[i("p",{staticStyle:{"font-size":"20px"}},[t._v(t._s(t.e))]),t._v(" "),i("p",{staticStyle:{"font-size":"25px",color:"#f68b1c"}},[t._v(t._s(t.y>0?t.y:0)+"元")]),t._v(" "),i("p",{staticStyle:{"font-size":"13px",color:"#999"}},[t._v("车口袋提供计时服务")])]),t._v(" "),i("div",{staticStyle:{background:"#e6e6e6",height:"0.13rem",width:"100%"}}),t._v(" "),i("ul",{staticClass:"payul"},[i("li",[i("div",{staticStyle:{}},[t._v("车牌号码")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.a))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("入场时间")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.g))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("停车时长")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.b))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("停车单价")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v(t._s(t.k)+"元/"+t._s(t.i?t.i:"小时"))])]),t._v(" "),i("li",{staticStyle:{background:"#e6e6e6",height:"0.13rem",width:"100%","margin-left":"0"}}),t._v(" "),i("li",{staticClass:"meiyong"},[i("div",{staticStyle:{}},[t._v("应付金额")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v("￥"+t._s(t.f))])]),t._v(" "),i("li",{staticClass:"meiyong",on:{click:t.tica}},[i("div",{staticStyle:{}},[t._v("优惠券")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[1==t.loack?i("span",[t._v("优惠券")]):t._e(),t._v(" "),2==t.loack?i("span",[t._v("免费时长"+t._s(t.disp)+"分钟")]):t._e(),t._v(" "),3==t.loack?i("span",[t._v("红包优惠"+t._s(t.disp)+"元")]):t._e(),t._v(" "),4==t.loack?i("span",[t._v("红包折扣"+t._s(t.disp)+"折")]):t._e(),t._v(" "),i("img",{staticStyle:{"vertical-align":"middle","margin-top":"-2px","margin-right":"-2px",width:"0.07rem",height:"0.12rem"},attrs:{src:a("LIqU")}})])]),t._v(" "),i("li",{staticClass:"meiyong",on:{click:t.deduction}},[i("div",{staticStyle:{}},[t._v("积分抵扣")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t.markmoney?i("span",[t._v("积分抵扣"+t._s(this.$route.query.val)+"元")]):t._e(),t._v(" "),t.markmoney?t._e():i("span"),t._v(" "),i("img",{staticStyle:{"vertical-align":"middle","margin-top":"-2px","margin-right":"-2px",width:"0.07rem",height:"0.12rem"},attrs:{src:a("LIqU")}})])]),t._v(" "),i("li",{staticClass:"meiyong"},[i("div",{staticStyle:{}},[t._v("优惠金额")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v("￥"+t._s(t.c))])]),t._v(" "),i("li",[i("div",{staticStyle:{}},[t._v("已付金额")]),t._v(" "),i("div",{staticStyle:{"margin-right":"4%"}},[t._v("￥"+t._s(t.d))])])]),t._v(" "),i("div",{staticStyle:{width:"92%",margin:"0 auto","font-size":"14px",color:"#b9b9b9","margin-top":"0.2rem","margin-bottom":"0.07rem"}},[t._m(0),t._v(" "),i("span",{staticStyle:{color:"#999","font-size":"11px"}},[t._v("请于付款后\n      "),i("span",[t._v(t._s(t.h))]),t._v("分钟离场，超时将加收停车费")])]),t._v(" "),i("div",{staticClass:"paytoot",on:{click:t.rightnow}},[t._v("立即付款")]),t._v(" "),i("router-view")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticStyle:{"vertical-align":"middle",width:"0.15rem",height:"0.15rem",display:"inline-block"}},[e("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:a("dIaG"),alt:""}})])}]};var u=a("VU/8")(l,m,!1,function(t){a("OgvM")},"data-v-492ec705",null);e.default=u.exports}});