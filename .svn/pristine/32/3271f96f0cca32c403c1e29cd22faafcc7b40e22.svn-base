webpackJsonp([83],{u4TD:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("woOf"),c=s.n(a),i=s("lHA8"),l=s.n(i),n=s("c/Tr"),o=s.n(n),r=s("mw3O"),h=s.n(r),u=s("OMN4"),d=s.n(u),p=s("UMo0"),g={name:"equipmentList",data:function(){return{checkbox:{checkedCities:[]},checked:!0,universal:{add:!1,change:!1,jurisdiction:!1,next:!1},paging:{page:1,pageSize:10,total:0},tableData:[],search:{userAlias:"",userName:""},change:{account:"",roleName:"",username:"",phone:"",email:""},options:[],dataUniversal:this.$store.state.activeName,updataUserId:""}},mounted:function(){document.title=this.$route.meta.title,this.searchClick(),console.log(this.dataUniversal)},methods:{hideclick:function(){this.universal.change=!1},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},updataClick:function(){var e=this;this.checkbox.checkedCities.sort(function(e,t){return e-t}),console.log(this.checkbox.checkedCities.join(",")),d()({method:"post",url:this.$store.state.url+"/s_user/update",data:h.a.stringify({permissions:this.checkbox.checkedCities.join(","),userId:this.updataUserId})}).then(function(t){console.log(t.data),0==t.data.resCode?e.$message({message:"保存成功",type:"success"}):e.$message({message:"保存失败",type:"error"})}),this.universal.jurisdiction=!1},handleCheckedCitiesChange:function(e){console.log(e);var t=e;console.log(t);for(var s=this.$store.state.sideList,a=this.$store.state.activeName,c=0;c<t.length;c++)for(var i=0;i<s.length;i++)t[c]==s[i].menuId&&"0"!=s[i].menuAssociated&&this.checkbox.checkedCities.push(s[i].menuAssociated);for(var n=0;n<a.length;n++){for(var r=a[n].classA.menuId,h=0;h<t.length;h++)for(var u=0;u<a[n].classB.length;u++)a[n].classB[u].menuId==t[h]&&(r="");var d=this.checkbox.checkedCities.indexOf(r);d>-1&&this.checkbox.checkedCities.splice(d,1)}this.checkbox.checkedCities=o()(new l.a(this.checkbox.checkedCities)),console.log(this.checkbox.checkedCities)},handleSizeChange:function(e){this.paging.pageSize=e,this.searchClick()},handleCurrentChange:function(e){this.searchClick()},addClick:function(){},deleteClick:function(e){var t=this;console.log(e);var s=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(p._50)("/s_user/delete",{userId:e.userId}).then(function(e){0==e.data.resCode?(s.$message({type:"success",message:"删除成功"}),s.searchClick()):s.$message({type:"error",message:"删除失败"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeShow:function(e){this.universal.change=!0,this.change=c()({},e),console.log(e)},changeClick:function(){var e=this;if(""==this.change.userAlias||""==this.change.phoneNum||""==this.change.emal)return this.$message.error("带*号的不能为空！"),!1;var t={userAlias:this.change.userAlias,phoneNum:this.change.phoneNum,email:this.change.emal,userId:this.change.userId};return new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$").test(this.change.emal)?/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(this.change.phoneNum)?(console.log(t),Object(p._50)("/s_user/update",t).then(function(t){0==t.data.resCode?(e.$message({type:"success",message:"修改成功"}),e.searchClick()):e.$message({type:"error",message:"修改失败"})}),void(this.universal.change=!1)):(this.$message.error("手机号码格式有误"),!1):(this.$message.error("邮箱格式不正确"),!1)},jurisdictionShow:function(e){var t=this;this.updataUserId=e.userId,d()({method:"post",url:this.$store.state.url+"/s_user/selecByUserId",data:h.a.stringify({userId:e.userId})}).then(function(e){console.log(e.data),0==e.data.resCode?"暂时无权限分配"==e.data.properties?t.checkbox.checkedCities=[]:t.checkbox.checkedCities=e.data.result.split(","):t.checkbox.checkedCities=[]}),console.log(e),this.universal.jurisdiction=!0},allClick:function(e){console.log(this.$store.state.activeName),console.log(e);var t=this.checkbox.checkedCities.indexOf(e);console.log(t);for(var s=void 0,a=0;a<this.$store.state.activeName.length;a++)this.$store.state.activeName[a].classA.menuId==e&&(s=this.$store.state.activeName[a]);if(console.log(s),t>-1)for(var c=0;c<s.classB.length;c++)this.checkbox.checkedCities.push(s.classB[c].menuId),console.log(s.classB[c].menuId);else for(var i=0;i<s.classB.length;i++){var l=this.checkbox.checkedCities.indexOf(s.classB[i].menuId);l>-1&&this.checkbox.checkedCities.splice(l,1)}},searchClick:function(){var e={page:this.paging.page,pageSize:this.paging.pageSize,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer"),type:4};this.search.userAlias&&(e.userAlias=this.search.userAlias),this.search.userName&&(e.userName=this.search.userName),console.log(e),e.dealer=localStorage.getItem("dealer");var t=this;t.tableData=[],Object(p._50)("/s_user/list",e).then(function(e){0==e.data.resCode?(t.paging.total=e.data.count,t.tableData=e.data.result):t.tableData=[]})}}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"InstallManList"}},[e._m(0),e._v(" "),s("div",{staticClass:"select"},[s("span",[e._v("用户名：")]),e._v(" "),s("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.userAlias,callback:function(t){e.$set(e.search,"userAlias",t)},expression:"search.userAlias"}}),e._v(" "),s("span",[e._v("账号：")]),e._v(" "),s("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.userName,callback:function(t){e.$set(e.search,"userName",t)},expression:"search.userName"}})],1),e._v(" "),s("div",{staticClass:"select"},[s("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("查询")])],1),e._v(" "),s("div",{staticClass:"Content"},[s("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{label:"账号\t",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{attrs:{trigger:"hover",placement:"top"}},[s("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.userName))]),e._v(" "),s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.userName))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用户名",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{attrs:{trigger:"hover",placement:"top"}},[s("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.userAlias))]),e._v(" "),s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.userAlias))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"绑定手机",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{attrs:{trigger:"hover",placement:"top"}},[s("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.phoneNum))]),e._v(" "),s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.phoneNum))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"绑定邮箱",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{attrs:{trigger:"hover",placement:"top"}},[s("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.emal))]),e._v(" "),s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.emal))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[s("i",{staticClass:"icon-change el-icon-edit",on:{click:function(s){e.changeShow(t.row)}}})]),e._v(" "),1==t.row.type?s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"权限",placement:"top"}},[s("i",{staticClass:"icon-unclick el-icon-menu"})]):s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"权限",placement:"top"}},[s("i",{staticClass:"icon-menu el-icon-menu",on:{click:function(s){e.jurisdictionShow(t.row)}}})]),e._v(" "),1==t.row.type?s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[s("i",{staticClass:"icon-unclick el-icon-delete"})]):s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[s("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(s){e.deleteClick(t.row)}}})])]}}])})],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"修改",visible:e.universal.change},on:{"update:visible":function(t){e.$set(e.universal,"change",t)}}},[s("div",[s("span",{staticClass:"spanClass"},[e._v("账号：")]),e._v(" "),s("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:e.change.userName,callback:function(t){e.$set(e.change,"userName",t)},expression:"change.userName"}}),s("br"),s("br"),e._v(" "),s("span",{staticClass:"spanClass"},[e._v("用户类型：")]),e._v(" "),s("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"维修安装人员"},model:{value:e.change.roleName,callback:function(t){e.$set(e.change,"roleName",t)},expression:"change.roleName"}}),s("br"),s("br"),e._v(" "),s("span",{staticClass:"spanClass"},[s("span",{staticClass:"aKey"},[e._v("*")]),e._v("用户名：")]),e._v(" "),s("el-input",{attrs:{disabled:!1,clearable:"",placeholder:"请输入内容"},model:{value:e.change.userAlias,callback:function(t){e.$set(e.change,"userAlias",t)},expression:"change.userAlias"}}),s("br"),s("br"),e._v(" "),s("span",{staticClass:"spanClass"},[s("span",{staticClass:"aKey"},[e._v("*")]),e._v("绑定手机：")]),e._v(" "),s("el-input",{attrs:{disabled:!1,clearable:"",placeholder:"请输入内容"},model:{value:e.change.phoneNum,callback:function(t){e.$set(e.change,"phoneNum",t)},expression:"change.phoneNum"}}),s("br"),s("br"),e._v(" "),s("span",{staticClass:"spanClass"},[s("span",{staticClass:"aKey"},[e._v("*")]),e._v("绑定邮箱：")]),e._v(" "),s("el-input",{attrs:{disabled:!1,clearable:"",placeholder:"请输入内容"},model:{value:e.change.emal,callback:function(t){e.$set(e.change,"emal",t)},expression:"change.emal"}})],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.hideclick}},[e._v("取消")]),e._v(" "),s("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.changeClick}},[e._v("修改")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"权限",visible:e.universal.jurisdiction},on:{"update:visible":function(t){e.$set(e.universal,"jurisdiction",t)}}},[s("div",[s("el-checkbox-group",{staticClass:"checkboxMarginLeft",on:{change:e.handleCheckedCitiesChange},model:{value:e.checkbox.checkedCities,callback:function(t){e.$set(e.checkbox,"checkedCities",t)},expression:"checkbox.checkedCities"}},e._l(this.$store.state.activeName,function(t){return s("div",[s("el-checkbox",{key:t.classA.menuId,staticClass:"checkboxMarginTop",attrs:{label:t.classA.menuId},on:{change:function(s){e.allClick(t.classA.menuId)}}},[e._v(e._s(t.classA.menuName))]),s("br"),e._v(" "),e._l(t.classB,function(t){return s("el-checkbox",{key:t.menuId,staticClass:"checkboxMarginLeft",attrs:{label:t.menuId}},[e._v(e._s(t.menuName))])}),s("br"),s("br")],2)}))],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal.jurisdiction=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.updataClick}},[e._v("保存")])],1)]),e._v(" "),s("div",{staticClass:"footer"},[s("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,11,12],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"headerTitle"},[t("span",[this._v("维修安装人员列表")])])])}]};var m=s("VU/8")(g,v,!1,function(e){s("xPKe")},"data-v-1c435687",null);t.default=m.exports},xPKe:function(e,t){}});