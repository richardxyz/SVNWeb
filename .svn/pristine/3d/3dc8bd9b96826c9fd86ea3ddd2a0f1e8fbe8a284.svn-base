webpackJsonp([21],{DVmn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),n=a("exGp"),l=a.n(n),o=a("bH6Z"),r=a("4s4v"),c=a("IYcQ"),d=a("UMo0"),u=(a("NYxO"),a("2UA+"),{components:{SyElTable:o.a,pageSize:c.default},data:function(){return{search:{alias:""},paging:{page:1,pageSize:10,total:0},tableData:[],parkIist:[],equipment:{sid:0,deviceId:"",alias:"",dealer:""},equipmentlist:[],addBox:!1,imgBox:!1,editBox:!1,realBox:!1,arrtable:[],deviceId:0,rules:r.a}},mounted:function(){this.getwashsiteList(),this.handleSearchClick()},computed:{},methods:{lck:function(e){console.log(file)},tijiao:function(){var e=this;console.log(this.deviceId);var t="";this.arrtable.forEach(function(e,a){t+=e+","}),t=t.substring(0,t.length-1),console.log(t);var a={file:t,eid:this.deviceId};Object(d.C)(a).then(function(t){0==t.data.resCode?(e.$message({message:"保存成功",type:"success"}),e.imgBox=!1):e.$message({message:"保存失败",type:"success"})})},getwashsiteList:function(){var e=this,t={page:1,pageSize:500,userId:localStorage.getItem("userId"),dealer:localStorage.getItem("dealer")};Object(d._24)(t).then(function(t){if(console.log(t),t.data.result.length>0){for(var a=0;a<t.data.result.length;a++){var s={sid:t.data.result[a].sid,sname:t.data.result[a].sname};e.parkIist.push(s)}console.log(e.parkIist)}else e.parkIist=[]})},handleSearchClick:function(){var e=this,t={};this.search.alias&&(t.alias=this.search.alias),t.page=this.paging.page,t.pageSize=this.paging.pageSize,t.userId=localStorage.getItem("userId"),t.dealer=localStorage.getItem("dealer"),Object(d._23)(t).then(function(t){if(console.log(t.data),0==t.data.resCode){e.tableData=t.data.result,e.paging.total=t.data.count;for(var a=0;a<t.data.count;a++){var s={id:t.data.result[a].id,alias:t.data.result[a].alias};e.equipmentlist.push(s)}}else e.tableData=[],e.paging.total=0})},handleRemove:function(e,t){console.log(e,t)},clear:function(){this.equipment={sid:0,deviceId:"",alias:"",dealer:""}},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},handleSizeChange:function(e){this.paging.pageSize=e,this.handleSearchClick()},handleCurrentChange:function(e){this.paging.page=e,this.handleSearchClick()},ClickAddEquipment:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.equipment.dealer=localStorage.getItem("dealer"),t.equipment.date=t.common.nowDate(),console.log(t.equipment),Object(d.i)(t.equipment).then(function(e){console.log(e),e?(t.addBox=!1,t.$message({message:"添加成功",type:"success"}),t.handleSearchClick()):t.$message({message:"添加失败",type:"warning"})}))})},ClickEditEquipment:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a={};a.dealer=localStorage.getItem("dealer"),a.sid=t.equipment.sid,a.id=t.equipment.id,a.alias=t.equipment.alias,a.deviceId=t.equipment.deviceId,Object(d._1)(a).then(function(e){console.log(e),0==e.data.resCode?(t.addBox=!1,t.$message({message:"修改成功",type:"success"}),t.handleSearchClick()):t.$message({message:e.data.errMsg,type:"error"})})}})},ClickDeleteequipment:function(e){var t=this;this.$confirm("确认删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("1"),Object(d.I)({id:e}).then(function(e){console.log(e),e?(t.$message({type:"success",message:"删除成功!"}),t.handleSearchClick()):t.$message({type:"error",message:"删除失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEditequipment:function(e){this.equipment=e,this.editBox=!0,this.addBox=!0},hangd:function(e,t){1==t.length&&this.$message({type:"error",message:"最多添加一个apk文件"})},hangds:function(e,t){5==t.length&&this.$message({type:"error",message:"最多上传5张图片"})},requasts:function(e){var t=this;return l()(i.a.mark(function a(){var s,n,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(s=new FormData).append("file",e.file),n={headers:{"Content-Type":"multipart/form-data"}},t.next=5,Object(d.r)(s,n);case 5:0==(l=t.sent).data.resCode&&console.log(l);case 7:case"end":return t.stop()}},a,t)}))()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},requast:function(e){var t=this;return l()(i.a.mark(function a(){var s,n,l;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(s=new FormData).append("file",e.file),n={headers:{"Content-Type":"multipart/form-data"}},a.next=5,Object(d._36)(s,n);case 5:0==(l=a.sent).data.resCode&&(console.log(l),console.log(l.data.imageUrl),t.$message.success("上传图片成功"),t.arrtable.push(l.data.imageUrl));case 7:case"end":return a.stop()}},a,t)}))()},handleset:function(e){this.deviceId=e,this.imgBox=!0},handleRealTime:function(e){this.deviceId=e,this.getRealBox({id:e})&&(console.log(this.$store.state,this.cellList),this.realBox=!0)},chosesname:function(e){return this.parkIist.forEach(function(t,a){t.sid==e&&(e=t.sname)}),e}}}),p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"equipmentList"}},[e._m(0),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("设备名称：")]),e._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择",clearable:""},model:{value:e.search.alias,callback:function(t){e.$set(e.search,"alias",t)},expression:"search.alias"}},[a("el-option",[e._v("未选择")]),e._v(" "),e._l(e.equipmentlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.alias,value:e.alias}})})],2)],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){e.addBox=!0,e.editBox=!1,e.clear()}}},[e._v("添加")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.handleSearchClick}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"设备序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.deviceId))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.deviceId))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设备名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.alias))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.alias))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(e._f("validate")(t.row.date)))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(e._f("validate")(t.row.date)))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("i",{staticClass:"icon-change el-icon-edit",on:{click:function(a){e.handleEditequipment(t.row)}}})]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(a){e.ClickDeleteequipment(t.row.id)}}})])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.editBox?"查看修改摄像头":"添加摄像头",visible:e.addBox},on:{"update:visible":function(t){e.addBox=t}}},[a("el-form",{ref:"equipment",attrs:{inline:!0,model:e.equipment,rules:e.rules}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备名称",prop:"alias"}},[a("el-input",{model:{value:e.equipment.alias,callback:function(t){e.$set(e.equipment,"alias",t)},expression:"equipment.alias"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备序号",prop:"deviceId"}},[a("el-input",{model:{value:e.equipment.deviceId,callback:function(t){e.$set(e.equipment,"deviceId",t)},expression:"equipment.deviceId"}})],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(t){e.addBox=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:function(t){e.editBox?e.ClickEditEquipment("equipment"):e.ClickAddEquipment("equipment")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,15,20],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"headerTitle"},[t("span",[this._v("摄像头管理")])])])}]};var g=a("VU/8")(u,p,!1,function(e){a("vI67")},"data-v-f89454ac",null);t.default=g.exports},vI67:function(e,t){}});